{"ast":null,"code":"var _jsxFileName = \"/Users/dhirajbalayar/Desktop/fashion/frontend/src/pages/Measure.jsx\",\n  _s = $RefreshSig$(),\n  _s2 = $RefreshSig$();\n// src/pages/Measure.jsx\nimport React, { useRef, useEffect, useState, useCallback } from \"react\";\nimport { Pose } from \"@mediapipe/pose\";\nimport { Camera } from \"@mediapipe/camera_utils\";\nimport { Camera as CameraIcon, Sparkles, Activity, Target, RotateCcw, Download } from 'lucide-react';\n\n/* ---------- Calibration ---------- */\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst A4_WIDTH_CM = 21.0; // reference width\nconst CHEST_MULTIPLIER = 1.75; // shoulder flat → chest circumference (tune 1.70–1.85)\nconst UPPER_WAIST_FACTOR = 0.90; // hip width ≈ a bit wider than upper waist\n\n/* ---------- Overlay helpers ---------- */\nconst UPPER = [[0, 1], [1, 2], [2, 3], [3, 7], [0, 11], [0, 12], [11, 13], [13, 15], [12, 14], [14, 16], [11, 12], [11, 23], [12, 24]];\nconst LOWER = [[23, 25], [25, 27], [27, 31], [24, 26], [26, 28], [28, 32], [23, 24]];\nconst drawSeg = (ctx, lm, a, b, color, width, W, H) => {\n  var _A$visibility, _B$visibility;\n  const A = lm[a],\n    B = lm[b];\n  if (!A || !B) return;\n  if (((_A$visibility = A.visibility) !== null && _A$visibility !== void 0 ? _A$visibility : 0) < 0.4 || ((_B$visibility = B.visibility) !== null && _B$visibility !== void 0 ? _B$visibility : 0) < 0.4) return;\n  ctx.strokeStyle = color;\n  ctx.lineWidth = width;\n  ctx.beginPath();\n  ctx.moveTo(A.x * W, A.y * H);\n  ctx.lineTo(B.x * W, B.y * H);\n  ctx.stroke();\n};\nconst drawBBox = (ctx, lm, W, H, color = \"rgba(0,255,0,0.9)\") => {\n  const pts = lm.filter(p => {\n    var _p$visibility;\n    return ((_p$visibility = p === null || p === void 0 ? void 0 : p.visibility) !== null && _p$visibility !== void 0 ? _p$visibility : 0) > 0.4;\n  });\n  if (!pts.length) return;\n  const xs = pts.map(p => p.x * W),\n    ys = pts.map(p => p.y * H);\n  const minX = Math.max(0, Math.min(...xs)),\n    maxX = Math.min(W, Math.max(...xs));\n  const minY = Math.max(0, Math.min(...ys)),\n    maxY = Math.min(H, Math.max(...ys));\n  const pad = 8;\n  ctx.strokeStyle = color;\n  ctx.lineWidth = 3;\n  ctx.strokeRect(minX - pad, minY - pad, maxX - minX + pad * 2, maxY - minY + pad * 2);\n};\n\n/* ---------- Size recommendation (using all three measurements) ---------- */\nconst recommendTopSize = (chestCm, waistCm, shoulderCm) => {\n  if (!chestCm || !waistCm || !shoulderCm || chestCm <= 0 || waistCm <= 0 || shoulderCm <= 0) {\n    return null;\n  }\n\n  // More sophisticated sizing algorithm that considers individual measurements\n  // This ensures even small differences in measurements result in different sizes\n\n  // Primary size based on chest (most important for tops)\n  // Using realistic size ranges based on actual human measurements\n  let primarySize = 'M';\n  if (chestCm < 80) primarySize = 'XXS'; // Very small frame\n  else if (chestCm < 85) primarySize = 'XS'; // Small frame\n  else if (chestCm < 90) primarySize = 'S'; // Small-medium frame\n  else if (chestCm < 95) primarySize = 'M'; // Medium frame (most common)\n  else if (chestCm < 100) primarySize = 'L'; // Large frame\n  else if (chestCm < 105) primarySize = 'XL'; // Extra large frame\n  else if (chestCm < 110) primarySize = 'XXL'; // 2X large frame\n  else if (chestCm < 115) primarySize = '3XL'; // 3X large frame\n  else primarySize = '4XL'; // 4X large frame\n\n  // Secondary adjustment based on waist-to-chest ratio\n  const waistChestRatio = waistCm / chestCm;\n  let sizeAdjustment = 0;\n  if (waistChestRatio < 0.80) {\n    // Very slim build - go down one size\n    sizeAdjustment = -1;\n  } else if (waistChestRatio > 0.90) {\n    // Fuller build - go up one size\n    sizeAdjustment = 1;\n  }\n\n  // Tertiary adjustment based on shoulder-to-chest ratio\n  const shoulderChestRatio = shoulderCm / chestCm;\n  if (shoulderChestRatio > 0.60) {\n    // Very broad shoulders - go up one size\n    sizeAdjustment += 1;\n  } else if (shoulderChestRatio < 0.50) {\n    // Very narrow shoulders - go down one size\n    sizeAdjustment -= 1;\n  }\n\n  // Apply size adjustments\n  const sizeOrder = ['XXS', 'XS', 'S', 'M', 'L', 'XL', 'XXL', '3XL', '4XL'];\n  const currentIndex = sizeOrder.indexOf(primarySize);\n  const adjustedIndex = Math.max(0, Math.min(sizeOrder.length - 1, currentIndex + sizeAdjustment));\n  const finalSize = sizeOrder[adjustedIndex];\n\n  // Log the calculation for debugging\n  console.log(`Size Calculation:`, {\n    chestCm,\n    waistCm,\n    shoulderCm,\n    primarySize,\n    waistChestRatio: waistChestRatio.toFixed(3),\n    shoulderChestRatio: shoulderChestRatio.toFixed(3),\n    sizeAdjustment,\n    finalSize\n  });\n  return finalSize;\n};\n\n// Optional style hint based on proportions (very light heuristic)\nconst styleHint = (chestCm, shoulderCm) => {\n  if (!chestCm || !shoulderCm) return \"\";\n  const ratio = chestCm / (shoulderCm || 1); // ~3–5 normal range\n  if (ratio < 3.6) return \"Try regular/relaxed fits.\";\n  if (ratio > 4.6) return \"Slim or tailored fits may suit better.\";\n  return \"Regular fit is likely comfortable.\";\n};\n\n// Add error handling wrapper at the top of the component\nconst MediaPipeErrorBoundary = ({\n  children\n}) => {\n  _s();\n  const [hasError, setHasError] = useState(false);\n  const [errorMessage, setErrorMessage] = useState('');\n  if (hasError) {\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"min-h-screen bg-gradient-to-br from-gray-900 via-blue-900 to-indigo-900 flex items-center justify-center\",\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"bg-white/95 backdrop-blur-md rounded-3xl p-8 max-w-lg text-center\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"w-16 h-16 bg-red-100 rounded-full flex items-center justify-center mx-auto mb-4\",\n          children: /*#__PURE__*/_jsxDEV(\"span\", {\n            className: \"text-2xl\",\n            children: \"\\u26A0\\uFE0F\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 128,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 127,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"h2\", {\n          className: \"text-2xl font-bold text-gray-800 mb-4\",\n          children: \"MediaPipe Error\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 130,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n          className: \"text-gray-600 mb-6\",\n          children: errorMessage\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 131,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"space-y-3\",\n          children: [/*#__PURE__*/_jsxDEV(\"button\", {\n            onClick: () => window.location.reload(),\n            className: \"w-full bg-blue-500 hover:bg-blue-600 text-white px-6 py-3 rounded-xl font-medium\",\n            children: \"\\uD83D\\uDD04 Refresh Page\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 133,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n            onClick: () => setHasError(false),\n            className: \"w-full bg-gray-200 hover:bg-gray-300 text-gray-700 px-6 py-3 rounded-xl font-medium\",\n            children: \"\\uD83D\\uDEAB Dismiss\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 139,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 132,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 126,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 125,\n      columnNumber: 7\n    }, this);\n  }\n  return /*#__PURE__*/_jsxDEV(ErrorBoundary, {\n    onError: error => {\n      console.error('MediaPipe Error:', error);\n      setErrorMessage(error.message || 'An error occurred with MediaPipe');\n      setHasError(true);\n    },\n    children: children\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 152,\n    columnNumber: 5\n  }, this);\n};\n\n// Simple ErrorBoundary component\n_s(MediaPipeErrorBoundary, \"xvQka5R1R2AC6iv/NclJPOwpfhU=\");\n_c = MediaPipeErrorBoundary;\nclass ErrorBoundary extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      hasError: false\n    };\n  }\n  static getDerivedStateFromError(error) {\n    return {\n      hasError: true\n    };\n  }\n  componentDidCatch(error, errorInfo) {\n    if (this.props.onError) {\n      this.props.onError(error);\n    }\n  }\n  render() {\n    if (this.state.hasError) {\n      return null; // Let parent handle the error display\n    }\n    return this.props.children;\n  }\n}\n\n/* ---------- Pose Landmarks for Upper Body ---------- */\nconst UPPER_BODY_LANDMARKS = [[11, 12],\n// shoulders\n[11, 13], [13, 15],\n// left arm\n[12, 14], [14, 16],\n// right arm\n[11, 23], [12, 24],\n// torso sides\n[23, 24] // hips\n];\n\n/* ---------- Accurate Size Recommendation for Upper Body ---------- */\nconst recommendUpperBodySize = measurements => {\n  const {\n    chestCm,\n    shoulderCm,\n    waistCm,\n    armLengthCm,\n    neckCm\n  } = measurements;\n\n  // Validate measurements\n  if (!chestCm || chestCm <= 0) return null;\n\n  // Primary size based on CHEST (most important for tops)\n  // Using standard US/UK sizing charts\n  let primarySize = 'M';\n  if (chestCm < 75) primarySize = 'XXS'; // Very small frame\n  else if (chestCm < 80) primarySize = 'XS'; // Small frame\n  else if (chestCm < 85) primarySize = 'S'; // Small-medium frame\n  else if (chestCm < 90) primarySize = 'M'; // Medium frame (most common)\n  else if (chestCm < 95) primarySize = 'L'; // Large frame\n  else if (chestCm < 100) primarySize = 'XL'; // Extra large frame\n  else if (chestCm < 105) primarySize = 'XXL'; // 2X large frame\n  else if (chestCm < 110) primarySize = '3XL'; // 3X large frame\n  else primarySize = '4XL'; // 4X large frame\n\n  // Secondary adjustment based on body proportions\n  let sizeAdjustment = 0;\n\n  // Waist-to-chest ratio adjustment\n  if (waistCm && chestCm) {\n    const waistChestRatio = waistCm / chestCm;\n    if (waistChestRatio < 0.75) {\n      // Very slim build - go down one size\n      sizeAdjustment = -1;\n    } else if (waistChestRatio > 0.85) {\n      // Fuller build - go up one size\n      sizeAdjustment = 1;\n    }\n  }\n\n  // Shoulder-to-chest ratio adjustment\n  if (shoulderCm && chestCm) {\n    const shoulderChestRatio = shoulderCm / chestCm;\n    if (shoulderChestRatio > 0.45) {\n      // Very broad shoulders - go up one size\n      sizeAdjustment += 1;\n    } else if (shoulderChestRatio < 0.35) {\n      // Very narrow shoulders - go down one size\n      sizeAdjustment -= 1;\n    }\n  }\n\n  // Apply size adjustments\n  const sizeOrder = ['XXS', 'XS', 'S', 'M', 'L', 'XL', 'XXL', '3XL', '4XL'];\n  const currentIndex = sizeOrder.indexOf(primarySize);\n  const adjustedIndex = Math.max(0, Math.min(sizeOrder.length - 1, currentIndex + sizeAdjustment));\n  const finalSize = sizeOrder[adjustedIndex];\n\n  // Log the calculation for debugging\n  console.log(`Upper Body Size Calculation:`, {\n    measurements,\n    primarySize,\n    sizeAdjustment,\n    finalSize\n  });\n  return finalSize;\n};\n\n// Simple pose drawing function\nconst drawPose = (ctx, landmarks, W, H) => {\n  var _leftShoulder$visibil, _rightShoulder$visibi, _leftHip$visibility, _rightHip$visibility;\n  if (!landmarks) return;\n\n  // Draw shoulder line\n  const leftShoulder = landmarks[11];\n  const rightShoulder = landmarks[12];\n  if (leftShoulder && rightShoulder && ((_leftShoulder$visibil = leftShoulder.visibility) !== null && _leftShoulder$visibil !== void 0 ? _leftShoulder$visibil : 0) > 0.5 && ((_rightShoulder$visibi = rightShoulder.visibility) !== null && _rightShoulder$visibi !== void 0 ? _rightShoulder$visibi : 0) > 0.5) {\n    ctx.strokeStyle = \"#3B82F6\";\n    ctx.lineWidth = 4;\n    ctx.beginPath();\n    ctx.moveTo(leftShoulder.x * W, leftShoulder.y * H);\n    ctx.lineTo(rightShoulder.x * W, rightShoulder.y * H);\n    ctx.stroke();\n\n    // Draw shoulder points\n    [leftShoulder, rightShoulder].forEach(point => {\n      ctx.fillStyle = \"#3B82F6\";\n      ctx.beginPath();\n      ctx.arc(point.x * W, point.y * H, 6, 0, Math.PI * 2);\n      ctx.fill();\n    });\n  }\n\n  // Draw torso outline\n  const leftHip = landmarks[23];\n  const rightHip = landmarks[24];\n  if (leftHip && rightHip && leftShoulder && rightShoulder && ((_leftHip$visibility = leftHip.visibility) !== null && _leftHip$visibility !== void 0 ? _leftHip$visibility : 0) > 0.5 && ((_rightHip$visibility = rightHip.visibility) !== null && _rightHip$visibility !== void 0 ? _rightHip$visibility : 0) > 0.5) {\n    ctx.strokeStyle = \"#10B981\";\n    ctx.lineWidth = 3;\n    ctx.beginPath();\n    ctx.moveTo(leftShoulder.x * W, leftShoulder.y * H);\n    ctx.lineTo(leftHip.x * W, leftHip.y * H);\n    ctx.lineTo(rightHip.x * W, rightHip.y * H);\n    ctx.lineTo(rightShoulder.x * W, rightShoulder.y * H);\n    ctx.closePath();\n    ctx.stroke();\n  }\n};\nexport default function Measure() {\n  _s2();\n  var _meas$chestCm, _meas$shoulderCm, _meas$waistCm, _meas$armLengthCm, _meas$neckCm;\n  const videoRef = useRef(null);\n  const canvasRef = useRef(null);\n  const poseRef = useRef(null);\n  const camRef = useRef(null);\n  const [phase, setPhase] = useState(\"calibrate\");\n  const [status, setStatus] = useState(\"Hold an A4 sheet at chest level and match the bar width.\");\n  const [barPx, setBarPx] = useState(300);\n  const [cmPerPx, setCmPerPx] = useState(null);\n  const [locked, setLocked] = useState(false);\n  const [meas, setMeas] = useState(null);\n\n  // Measurement buffers for stability\n  const chestBuf = useRef([]);\n  const shoulderBuf = useRef([]);\n  const waistBuf = useRef([]);\n  const armBuf = useRef([]);\n  const neckBuf = useRef([]);\n  const STABILITY_FRAMES = 10;\n  const MOVEMENT_EPS = 0.02;\n\n  // Get distance between two points\n  const getDistance = useCallback((a, b) => {\n    if (!a || !b) return 0;\n    const dx = a.x - b.x,\n      dy = a.y - b.y;\n    return Math.sqrt(dx * dx + dy * dy);\n  }, []);\n\n  // Calculate actual chest circumference from shoulder width\n  const calculateChestCircumference = shoulderWidthCm => {\n    // More accurate formula: chest circumference ≈ shoulder width × 2.2\n    // This accounts for the fact that chest goes around the body, not just across\n    return shoulderWidthCm * 2.2;\n  };\n\n  // Calculate waist circumference from hip width\n  const calculateWaistCircumference = hipWidthCm => {\n    // Waist is typically 0.85-0.95 of hip width\n    return hipWidthCm * 0.9;\n  };\n\n  // Calculate arm length from shoulder to wrist\n  const calculateArmLength = (shoulderPoint, wristPoint, cmPerPx, W, H) => {\n    if (!shoulderPoint || !wristPoint) return null;\n    const shoulderPx = Math.sqrt(Math.pow((shoulderPoint.x - wristPoint.x) * W, 2) + Math.pow((shoulderPoint.y - wristPoint.y) * H, 2));\n    return shoulderPx * cmPerPx;\n  };\n\n  // Calculate neck circumference (approximate from shoulder width)\n  const calculateNeckCircumference = shoulderWidthCm => {\n    // Neck is typically 0.25-0.30 of shoulder width\n    return shoulderWidthCm * 0.28;\n  };\n\n  // Camera management functions\n  const startCamera = useCallback(async pose => {\n    if (!videoRef.current || !pose) return;\n    const video = videoRef.current;\n\n    // Prevent multiple simultaneous start attempts\n    if (camRef.current) return;\n    try {\n      // Stop any existing video tracks first\n      if (video.srcObject) {\n        video.srcObject.getTracks().forEach(track => track.stop());\n        video.srcObject = null;\n      }\n\n      // Wait a bit for cleanup\n      await new Promise(resolve => setTimeout(resolve, 100));\n\n      // Get new camera stream\n      const stream = await navigator.mediaDevices.getUserMedia({\n        video: {\n          width: 1280,\n          height: 720,\n          facingMode: 'user'\n        }\n      });\n\n      // Set video source and wait for it to be ready\n      video.srcObject = stream;\n\n      // Wait for video to be ready before playing\n      await new Promise((resolve, reject) => {\n        video.onloadedmetadata = resolve;\n        video.onerror = reject;\n        // Timeout after 5 seconds\n        setTimeout(() => reject(new Error('Video load timeout')), 5000);\n      });\n\n      // Start playing video\n      try {\n        await video.play();\n      } catch (playError) {\n        console.warn('Video play failed, trying alternative method:', playError);\n        // Fallback: try to play without await\n        video.play().catch(e => console.warn('Fallback play failed:', e));\n      }\n\n      // Create and start camera for pose detection\n      const cameraInstance = new Camera(video, {\n        onFrame: async () => {\n          try {\n            await pose.send({\n              image: video\n            });\n          } catch (error) {\n            console.warn('Pose detection error:', error);\n          }\n        },\n        width: 1280,\n        height: 720\n      });\n      cameraInstance.start();\n      camRef.current = cameraInstance;\n      console.log('Camera started successfully');\n    } catch (error) {\n      console.error('Camera start error:', error);\n      setStatus('Camera error: ' + (error.message || 'Failed to start camera'));\n    }\n  }, []);\n  const stopCamera = useCallback(() => {\n    try {\n      if (camRef.current) {\n        camRef.current.stop();\n        camRef.current = null;\n      }\n      if (videoRef.current && videoRef.current.srcObject) {\n        videoRef.current.srcObject.getTracks().forEach(track => track.stop());\n        videoRef.current.srcObject = null;\n      }\n      console.log('Camera stopped successfully');\n    } catch (error) {\n      console.warn('Camera stop error:', error);\n    }\n  }, []);\n  useEffect(() => {\n    if (!videoRef.current || !canvasRef.current) return;\n    const video = videoRef.current;\n    const canvas = canvasRef.current;\n    const ctx = canvas.getContext('2d');\n\n    // Set canvas size to match video\n    canvas.width = 1280;\n    canvas.height = 720;\n    const pose = new Pose({\n      locateFile: file => {\n        return `https://cdn.jsdelivr.net/npm/@mediapipe/pose/${file}`;\n      }\n    });\n    pose.setOptions({\n      modelComplexity: 1,\n      smoothLandmarks: true,\n      enableSegmentation: false,\n      smoothSegmentation: false,\n      minDetectionConfidence: 0.5,\n      minTrackingConfidence: 0.5\n    });\n    let isStarting = false;\n    pose.onResults(res => {\n      if (!res.poseLandmarks) {\n        setStatus(\"Detecting body...\");\n        return;\n      }\n      const W = canvas.width,\n        H = canvas.height;\n      ctx.clearRect(0, 0, W, H);\n\n      // Draw pose\n      drawPose(ctx, res.poseLandmarks, W, H);\n      const landmarks = res.poseLandmarks;\n      const vis = i => {\n        var _landmarks$i$visibili, _landmarks$i;\n        return ((_landmarks$i$visibili = (_landmarks$i = landmarks[i]) === null || _landmarks$i === void 0 ? void 0 : _landmarks$i.visibility) !== null && _landmarks$i$visibili !== void 0 ? _landmarks$i$visibili : 0) > 0.5;\n      };\n\n      // Check if key points are visible\n      const shouldersOK = vis(11) && vis(12);\n      const hipsOK = vis(23) && vis(24);\n      const wristsOK = vis(15) && vis(16);\n      if (!shouldersOK || !hipsOK) {\n        setStatus(\"Show shoulders and upper torso clearly.\");\n        return;\n      }\n      if (phase === \"calibrate\") {\n        setStatus(\"Adjust bar → Set calibration.\");\n        return;\n      }\n      if (!cmPerPx) {\n        setStatus(\"Click Set calibration first.\");\n        return;\n      }\n\n      // Calculate measurements\n      const leftShoulder = landmarks[11];\n      const rightShoulder = landmarks[12];\n      const leftHip = landmarks[23];\n      const rightHip = landmarks[24];\n      const leftWrist = landmarks[15];\n      const rightWrist = landmarks[16];\n\n      // Shoulder width\n      const shoulderPx = Math.abs((leftShoulder.x - rightShoulder.x) * W);\n      const shoulderCm = shoulderPx * cmPerPx;\n\n      // Hip width (for waist calculation)\n      const hipPx = Math.abs((leftHip.x - rightHip.x) * W);\n      const hipCm = hipPx * cmPerPx;\n\n      // Calculate all measurements\n      const chestCm = calculateChestCircumference(shoulderCm);\n      const waistCm = calculateWaistCircumference(hipCm);\n      const armLengthCm = calculateArmLength(leftShoulder, leftWrist, cmPerPx, W, H);\n      const neckCm = calculateNeckCircumference(shoulderCm);\n\n      // Store in buffers for stability\n      const pushToBuffer = (buffer, value) => {\n        if (value && value > 0) {\n          buffer.current.push(value);\n          if (buffer.current.length > STABILITY_FRAMES) {\n            buffer.current.shift();\n          }\n        }\n      };\n      pushToBuffer(chestBuf, chestCm);\n      pushToBuffer(shoulderBuf, shoulderCm);\n      pushToBuffer(waistBuf, waistCm);\n      pushToBuffer(armBuf, armLengthCm);\n      pushToBuffer(neckBuf, neckCm);\n\n      // Check stability\n      const isStable = chestBuf.current.length >= STABILITY_FRAMES && shoulderBuf.current.length >= STABILITY_FRAMES;\n      if (isStable) {\n        // Get median values for stability\n        const getMedian = buffer => {\n          if (buffer.current.length === 0) return null;\n          const sorted = [...buffer.current].sort((a, b) => a - b);\n          const mid = Math.floor(sorted.length / 2);\n          return sorted.length % 2 === 0 ? (sorted[mid - 1] + sorted[mid]) / 2 : sorted[mid];\n        };\n        const stableMeasurements = {\n          chestCm: Number(getMedian(chestBuf).toFixed(1)),\n          shoulderCm: Number(getMedian(shoulderBuf).toFixed(1)),\n          waistCm: Number(getMedian(waistBuf).toFixed(1)),\n          armLengthCm: getMedian(armBuf) ? Number(getMedian(armBuf).toFixed(1)) : null,\n          neckCm: Number(getMedian(neckBuf).toFixed(1))\n        };\n        setMeas(stableMeasurements);\n        setLocked(true);\n        setPhase(\"locked\");\n        setStatus(\"Measurements locked! ✅\");\n        stopCamera();\n      } else {\n        setStatus(\"Hold still for stable measurements...\");\n      }\n    });\n\n    // Start camera when ready\n    const startWhenReady = () => {\n      if (video.readyState >= 2) {\n        // HAVE_CURRENT_DATA\n        startCamera(pose);\n      } else {\n        video.addEventListener('canplay', () => startCamera(pose), {\n          once: true\n        });\n      }\n    };\n    startWhenReady();\n    poseRef.current = pose;\n    return () => {\n      stopCamera();\n      if (poseRef.current) {\n        poseRef.current.close();\n      }\n      // Additional cleanup to prevent video play errors\n      if (video.srcObject) {\n        video.srcObject.getTracks().forEach(track => track.stop());\n        video.srcObject = null;\n      }\n    };\n  }, [phase, cmPerPx, getDistance]);\n  const setCalibration = () => {\n    if (barPx < 40) return;\n    setCmPerPx(A4_WIDTH_CM / barPx);\n    setPhase(\"measure\");\n    setStatus(\"Calibration set. Stand centered with shoulders visible.\");\n\n    // Reset buffers\n    chestBuf.current = [];\n    shoulderBuf.current = [];\n    waistBuf.current = [];\n    armBuf.current = [];\n    neckBuf.current = [];\n  };\n  const retake = () => {\n    setLocked(false);\n    setMeas(null);\n    setPhase(\"measure\");\n    setStatus(\"Stand centered; hold still for measurements.\");\n\n    // Reset buffers\n    chestBuf.current = [];\n    shoulderBuf.current = [];\n    waistBuf.current = [];\n    armBuf.current = [];\n    neckBuf.current = [];\n\n    // Restart camera after a short delay\n    setTimeout(() => {\n      if (poseRef.current && !locked) {\n        startCamera(poseRef.current);\n      }\n    }, 500);\n  };\n  const recalibrate = () => {\n    setLocked(false);\n    setMeas(null);\n    setPhase(\"calibrate\");\n    setStatus(\"Hold an A4 sheet at chest level and match the bar width.\");\n\n    // Reset buffers\n    chestBuf.current = [];\n    shoulderBuf.current = [];\n    waistBuf.current = [];\n    armBuf.current = [];\n    neckBuf.current = [];\n\n    // Restart camera after a short delay\n    setTimeout(() => {\n      if (poseRef.current && !locked) {\n        startCamera(poseRef.current);\n      }\n    }, 500);\n  };\n\n  // Get status icon\n  const getStatusIcon = () => {\n    if (phase === \"locked\") return /*#__PURE__*/_jsxDEV(\"span\", {\n      className: \"text-emerald-500 text-xl\",\n      children: \"\\u2705\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 677,\n      columnNumber: 36\n    }, this);\n    if (phase === \"measure\") return /*#__PURE__*/_jsxDEV(Activity, {\n      className: \"w-5 h-5 text-blue-500 animate-pulse\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 678,\n      columnNumber: 37\n    }, this);\n    return /*#__PURE__*/_jsxDEV(Target, {\n      className: \"w-5 h-5 text-amber-500\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 679,\n      columnNumber: 12\n    }, this);\n  };\n\n  // Get phase color\n  const getPhaseColor = () => {\n    if (phase === \"locked\") return \"from-emerald-500 to-green-500\";\n    if (phase === \"measure\") return \"from-blue-500 to-cyan-500\";\n    return \"from-amber-500 to-orange-500\";\n  };\n  return /*#__PURE__*/_jsxDEV(MediaPipeErrorBoundary, {\n    children: /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"min-h-screen bg-gradient-to-br from-gray-900 via-blue-900 to-indigo-900 relative overflow-hidden\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"absolute inset-0\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"absolute top-10 left-10 w-72 h-72 bg-blue-500/10 rounded-full blur-3xl animate-pulse\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 694,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"absolute bottom-10 right-10 w-96 h-96 bg-emerald-500/10 rounded-full blur-3xl animate-pulse delay-1000\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 695,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 693,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"relative z-10 flex flex-col items-center min-h-screen\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"w-full max-w-7xl flex items-center justify-between px-6 py-6\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"flex items-center space-x-4\",\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"w-12 h-12 bg-gradient-to-r from-blue-500 to-emerald-500 rounded-2xl flex items-center justify-center shadow-lg\",\n              children: /*#__PURE__*/_jsxDEV(Sparkles, {\n                className: \"w-7 h-7 text-white\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 703,\n                columnNumber: 17\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 702,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              children: [/*#__PURE__*/_jsxDEV(\"h1\", {\n                className: \"text-2xl font-bold text-white\",\n                children: \"AI Fashion Fit\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 706,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n                className: \"text-sm text-blue-200\",\n                children: \"Upper Body Measurement System\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 707,\n                columnNumber: 17\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 705,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 701,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"flex items-center space-x-3\",\n            children: /*#__PURE__*/_jsxDEV(\"div\", {\n              className: `bg-gradient-to-r ${getPhaseColor()} rounded-full px-6 py-3 shadow-lg backdrop-blur-sm border border-white/10`,\n              children: /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"flex items-center space-x-3 text-white\",\n                children: [getStatusIcon(), /*#__PURE__*/_jsxDEV(\"span\", {\n                  className: \"font-medium text-sm\",\n                  children: status\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 716,\n                  columnNumber: 19\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 714,\n                columnNumber: 17\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 713,\n              columnNumber: 15\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 712,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 700,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"w-full max-w-6xl px-6 flex-1 flex items-center\",\n          children: /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"relative w-full bg-black/20 backdrop-blur-lg rounded-3xl overflow-hidden shadow-2xl border border-white/10\",\n            children: /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"relative aspect-video\",\n              children: [/*#__PURE__*/_jsxDEV(\"video\", {\n                ref: videoRef,\n                className: \"absolute inset-0 w-full h-full object-contain bg-black rounded-3xl\",\n                autoPlay: true,\n                muted: true,\n                playsInline: true\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 726,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"canvas\", {\n                ref: canvasRef,\n                className: \"absolute inset-0 w-full h-full object-contain pointer-events-none\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 727,\n                columnNumber: 17\n              }, this), phase === \"calibrate\" && /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"absolute bottom-6 left-1/2 transform -translate-x-1/2\",\n                children: /*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"bg-white/95 backdrop-blur-md rounded-2xl px-6 py-4 shadow-2xl border border-white/20\",\n                  children: /*#__PURE__*/_jsxDEV(\"div\", {\n                    className: \"flex items-center space-x-4\",\n                    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                      className: \"flex items-center space-x-2\",\n                      children: [/*#__PURE__*/_jsxDEV(Target, {\n                        className: \"w-5 h-5 text-amber-600\"\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 735,\n                        columnNumber: 27\n                      }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                        className: \"text-sm font-medium text-gray-700\",\n                        children: \"A4 width calibration\"\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 736,\n                        columnNumber: 27\n                      }, this)]\n                    }, void 0, true, {\n                      fileName: _jsxFileName,\n                      lineNumber: 734,\n                      columnNumber: 25\n                    }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n                      type: \"range\",\n                      min: 120,\n                      max: 900,\n                      value: barPx,\n                      onChange: e => setBarPx(Number(e.target.value)),\n                      className: \"w-64 accent-blue-500\"\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 738,\n                      columnNumber: 25\n                    }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n                      onClick: setCalibration,\n                      className: \"bg-gradient-to-r from-blue-500 to-emerald-500 hover:from-blue-600 hover:to-emerald-600 text-white px-6 py-2 rounded-xl font-medium transition-all duration-300 transform hover:scale-105 shadow-lg flex items-center space-x-2\",\n                      children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                        className: \"text-white text-lg\",\n                        children: \"\\u2705\"\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 750,\n                        columnNumber: 27\n                      }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                        children: \"Set Calibration\"\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 751,\n                        columnNumber: 27\n                      }, this)]\n                    }, void 0, true, {\n                      fileName: _jsxFileName,\n                      lineNumber: 746,\n                      columnNumber: 25\n                    }, this)]\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 733,\n                    columnNumber: 23\n                  }, this)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 732,\n                  columnNumber: 21\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 731,\n                columnNumber: 19\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 725,\n              columnNumber: 15\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 724,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 723,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"w-full max-w-4xl px-6 py-4\",\n          children: /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"bg-white/10 backdrop-blur-md rounded-2xl p-6 border border-white/20\",\n            children: /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"text-center text-white\",\n              children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"flex items-center justify-center space-x-2 mb-3\",\n                children: [/*#__PURE__*/_jsxDEV(CameraIcon, {\n                  className: \"w-5 h-5 text-blue-300\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 766,\n                  columnNumber: 19\n                }, this), /*#__PURE__*/_jsxDEV(\"h3\", {\n                  className: \"font-semibold\",\n                  children: \"Instructions\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 767,\n                  columnNumber: 19\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 765,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"text-sm text-white/80 space-y-2\",\n                children: [phase === \"calibrate\" && /*#__PURE__*/_jsxDEV(\"p\", {\n                  children: \"\\uD83D\\uDCC4 Hold an A4 sheet at chest level and adjust the bar to match its width for accurate calibration.\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 771,\n                  columnNumber: 21\n                }, this), phase === \"measure\" && /*#__PURE__*/_jsxDEV(\"p\", {\n                  children: \"\\uD83E\\uDDCD Stand straight with arms slightly away from your body. Show shoulders and upper torso clearly.\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 774,\n                  columnNumber: 21\n                }, this), phase === \"locked\" && /*#__PURE__*/_jsxDEV(\"p\", {\n                  children: \"\\u2705 Upper body measurements captured successfully! You can retake if needed or get recommendations.\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 777,\n                  columnNumber: 21\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 769,\n                columnNumber: 17\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 764,\n              columnNumber: 15\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 763,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 762,\n          columnNumber: 11\n        }, this), phase === \"locked\" && meas && /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"w-full max-w-4xl px-6 py-6\",\n          children: /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"bg-white/95 backdrop-blur-md rounded-2xl p-6 border border-gray-200 shadow-xl\",\n            children: /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"text-center text-gray-800\",\n              children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n                className: \"text-xl font-bold mb-4\",\n                children: \"\\uD83D\\uDCCA Upper Body Measurements\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 789,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"grid grid-cols-1 md:grid-cols-3 gap-4 mb-6\",\n                children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"bg-blue-50 rounded-xl p-4 border border-blue-200\",\n                  children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                    className: \"text-2xl font-bold text-blue-600\",\n                    children: ((_meas$chestCm = meas.chestCm) === null || _meas$chestCm === void 0 ? void 0 : _meas$chestCm.toFixed(1)) || 'N/A'\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 794,\n                    columnNumber: 23\n                  }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                    className: \"text-sm text-blue-500\",\n                    children: \"Chest (cm)\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 795,\n                    columnNumber: 23\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 793,\n                  columnNumber: 21\n                }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"bg-emerald-50 rounded-xl p-4 border border-emerald-200\",\n                  children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                    className: \"text-2xl font-bold text-emerald-600\",\n                    children: ((_meas$shoulderCm = meas.shoulderCm) === null || _meas$shoulderCm === void 0 ? void 0 : _meas$shoulderCm.toFixed(1)) || 'N/A'\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 798,\n                    columnNumber: 23\n                  }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                    className: \"text-sm text-emerald-500\",\n                    children: \"Shoulder (cm)\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 799,\n                    columnNumber: 23\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 797,\n                  columnNumber: 21\n                }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"bg-purple-50 rounded-xl p-4 border border-purple-200\",\n                  children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                    className: \"text-2xl font-bold text-purple-600\",\n                    children: ((_meas$waistCm = meas.waistCm) === null || _meas$waistCm === void 0 ? void 0 : _meas$waistCm.toFixed(1)) || 'N/A'\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 802,\n                    columnNumber: 23\n                  }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                    className: \"text-sm text-purple-500\",\n                    children: \"Waist (cm)\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 803,\n                    columnNumber: 23\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 801,\n                  columnNumber: 21\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 792,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"grid grid-cols-1 md:grid-cols-2 gap-4 mb-6\",\n                children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"bg-orange-50 rounded-xl p-4 border border-orange-200\",\n                  children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                    className: \"text-xl font-bold text-orange-600\",\n                    children: ((_meas$armLengthCm = meas.armLengthCm) === null || _meas$armLengthCm === void 0 ? void 0 : _meas$armLengthCm.toFixed(1)) || 'N/A'\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 810,\n                    columnNumber: 23\n                  }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                    className: \"text-sm text-orange-500\",\n                    children: \"Arm Length (cm)\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 811,\n                    columnNumber: 23\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 809,\n                  columnNumber: 21\n                }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"bg-pink-50 rounded-xl p-4 border border-pink-200\",\n                  children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                    className: \"text-xl font-bold text-pink-600\",\n                    children: ((_meas$neckCm = meas.neckCm) === null || _meas$neckCm === void 0 ? void 0 : _meas$neckCm.toFixed(1)) || 'N/A'\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 814,\n                    columnNumber: 23\n                  }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                    className: \"text-sm text-pink-500\",\n                    children: \"Neck (cm)\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 815,\n                    columnNumber: 23\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 813,\n                  columnNumber: 21\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 808,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"bg-gradient-to-r from-blue-50 to-emerald-50 rounded-xl p-4 mb-6 border border-blue-200\",\n                children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"text-lg font-semibold text-gray-700 mb-2\",\n                  children: \"Recommended Upper Body Size\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 821,\n                  columnNumber: 21\n                }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"text-3xl font-bold bg-gradient-to-r from-blue-600 to-emerald-600 bg-clip-text text-transparent\",\n                  children: recommendUpperBodySize(meas)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 822,\n                  columnNumber: 21\n                }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"text-sm text-gray-600 mt-2\",\n                  children: \"Based on chest, shoulder, waist, arm length, and neck measurements\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 825,\n                  columnNumber: 21\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 820,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"flex flex-col sm:flex-row gap-3 justify-center\",\n                children: [/*#__PURE__*/_jsxDEV(\"button\", {\n                  onClick: retake,\n                  className: \"bg-gray-200 hover:bg-gray-300 text-gray-700 px-6 py-3 rounded-xl font-medium transition-all duration-300 border-2 border-gray-300\",\n                  children: \"\\uD83D\\uDD04 Retake\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 832,\n                  columnNumber: 21\n                }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n                  onClick: recalibrate,\n                  className: \"bg-blue-100 hover:bg-blue-200 text-blue-700 px-6 py-3 rounded-xl font-medium transition-all duration-300 border-2 border-blue-300\",\n                  children: \"\\uD83C\\uDFAF Recalibrate\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 838,\n                  columnNumber: 21\n                }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n                  onClick: () => {\n                    const recommendedSize = recommendUpperBodySize(meas);\n                    if (recommendedSize) {\n                      const measurementData = encodeURIComponent(JSON.stringify({\n                        size: recommendedSize,\n                        gender: 'Men',\n                        measurements: meas\n                      }));\n                      window.location.href = `/recommendations?data=${measurementData}`;\n                    }\n                  },\n                  className: \"bg-gradient-to-r from-purple-500 to-pink-500 hover:from-purple-600 hover:to-pink-600 text-white px-6 py-3 rounded-xl font-medium transition-all duration-300 shadow-lg\",\n                  children: \"\\u2728 Get Recommendations\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 844,\n                  columnNumber: 21\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 831,\n                columnNumber: 19\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 788,\n              columnNumber: 17\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 787,\n            columnNumber: 15\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 786,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 698,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 691,\n      columnNumber: 7\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 690,\n    columnNumber: 5\n  }, this);\n}\n_s2(Measure, \"pYua4gmiqq+68ERAk74PGZq06+Y=\");\n_c2 = Measure;\nvar _c, _c2;\n$RefreshReg$(_c, \"MediaPipeErrorBoundary\");\n$RefreshReg$(_c2, \"Measure\");","map":{"version":3,"names":["React","useRef","useEffect","useState","useCallback","Pose","Camera","CameraIcon","Sparkles","Activity","Target","RotateCcw","Download","jsxDEV","_jsxDEV","A4_WIDTH_CM","CHEST_MULTIPLIER","UPPER_WAIST_FACTOR","UPPER","LOWER","drawSeg","ctx","lm","a","b","color","width","W","H","_A$visibility","_B$visibility","A","B","visibility","strokeStyle","lineWidth","beginPath","moveTo","x","y","lineTo","stroke","drawBBox","pts","filter","p","_p$visibility","length","xs","map","ys","minX","Math","max","min","maxX","minY","maxY","pad","strokeRect","recommendTopSize","chestCm","waistCm","shoulderCm","primarySize","waistChestRatio","sizeAdjustment","shoulderChestRatio","sizeOrder","currentIndex","indexOf","adjustedIndex","finalSize","console","log","toFixed","styleHint","ratio","MediaPipeErrorBoundary","children","_s","hasError","setHasError","errorMessage","setErrorMessage","className","fileName","_jsxFileName","lineNumber","columnNumber","onClick","window","location","reload","ErrorBoundary","onError","error","message","_c","Component","constructor","props","state","getDerivedStateFromError","componentDidCatch","errorInfo","render","UPPER_BODY_LANDMARKS","recommendUpperBodySize","measurements","armLengthCm","neckCm","drawPose","landmarks","_leftShoulder$visibil","_rightShoulder$visibi","_leftHip$visibility","_rightHip$visibility","leftShoulder","rightShoulder","forEach","point","fillStyle","arc","PI","fill","leftHip","rightHip","closePath","Measure","_s2","_meas$chestCm","_meas$shoulderCm","_meas$waistCm","_meas$armLengthCm","_meas$neckCm","videoRef","canvasRef","poseRef","camRef","phase","setPhase","status","setStatus","barPx","setBarPx","cmPerPx","setCmPerPx","locked","setLocked","meas","setMeas","chestBuf","shoulderBuf","waistBuf","armBuf","neckBuf","STABILITY_FRAMES","MOVEMENT_EPS","getDistance","dx","dy","sqrt","calculateChestCircumference","shoulderWidthCm","calculateWaistCircumference","hipWidthCm","calculateArmLength","shoulderPoint","wristPoint","shoulderPx","pow","calculateNeckCircumference","startCamera","pose","current","video","srcObject","getTracks","track","stop","Promise","resolve","setTimeout","stream","navigator","mediaDevices","getUserMedia","height","facingMode","reject","onloadedmetadata","onerror","Error","play","playError","warn","catch","e","cameraInstance","onFrame","send","image","start","stopCamera","canvas","getContext","locateFile","file","setOptions","modelComplexity","smoothLandmarks","enableSegmentation","smoothSegmentation","minDetectionConfidence","minTrackingConfidence","isStarting","onResults","res","poseLandmarks","clearRect","vis","i","_landmarks$i$visibili","_landmarks$i","shouldersOK","hipsOK","wristsOK","leftWrist","rightWrist","abs","hipPx","hipCm","pushToBuffer","buffer","value","push","shift","isStable","getMedian","sorted","sort","mid","floor","stableMeasurements","Number","startWhenReady","readyState","addEventListener","once","close","setCalibration","retake","recalibrate","getStatusIcon","getPhaseColor","ref","autoPlay","muted","playsInline","type","onChange","target","recommendedSize","measurementData","encodeURIComponent","JSON","stringify","size","gender","href","_c2","$RefreshReg$"],"sources":["/Users/dhirajbalayar/Desktop/fashion/frontend/src/pages/Measure.jsx"],"sourcesContent":["// src/pages/Measure.jsx\nimport React, { useRef, useEffect, useState, useCallback } from \"react\";\nimport { Pose } from \"@mediapipe/pose\";\nimport { Camera } from \"@mediapipe/camera_utils\";\nimport { Camera as CameraIcon, Sparkles, Activity, Target, RotateCcw, Download } from 'lucide-react';\n\n/* ---------- Calibration ---------- */\nconst A4_WIDTH_CM = 21.0; // reference width\nconst CHEST_MULTIPLIER = 1.75; // shoulder flat → chest circumference (tune 1.70–1.85)\nconst UPPER_WAIST_FACTOR = 0.90; // hip width ≈ a bit wider than upper waist\n\n/* ---------- Overlay helpers ---------- */\nconst UPPER = [\n  [0,1],[1,2],[2,3],[3,7],\n  [0,11],[0,12],\n  [11,13],[13,15],\n  [12,14],[14,16],\n  [11,12],\n  [11,23],[12,24],\n];\nconst LOWER = [\n  [23,25],[25,27],[27,31],\n  [24,26],[26,28],[28,32],\n  [23,24],\n];\nconst drawSeg = (ctx, lm, a, b, color, width, W, H) => {\n  const A = lm[a], B = lm[b];\n  if (!A || !B) return;\n  if ((A.visibility ?? 0) < 0.4 || (B.visibility ?? 0) < 0.4) return;\n  ctx.strokeStyle = color; ctx.lineWidth = width;\n  ctx.beginPath(); ctx.moveTo(A.x*W, A.y*H); ctx.lineTo(B.x*W, B.y*H); ctx.stroke();\n};\nconst drawBBox = (ctx, lm, W, H, color=\"rgba(0,255,0,0.9)\") => {\n  const pts = lm.filter(p => (p?.visibility ?? 0) > 0.4);\n  if (!pts.length) return;\n  const xs = pts.map(p=>p.x*W), ys = pts.map(p=>p.y*H);\n  const minX = Math.max(0, Math.min(...xs)), maxX = Math.min(W, Math.max(...xs));\n  const minY = Math.max(0, Math.min(...ys)), maxY = Math.min(H, Math.max(...ys));\n  const pad = 8; ctx.strokeStyle = color; ctx.lineWidth = 3;\n  ctx.strokeRect(minX-pad, minY-pad, (maxX-minX)+pad*2, (maxY-minY)+pad*2);\n};\n\n/* ---------- Size recommendation (using all three measurements) ---------- */\nconst recommendTopSize = (chestCm, waistCm, shoulderCm) => {\n  if (!chestCm || !waistCm || !shoulderCm || chestCm <= 0 || waistCm <= 0 || shoulderCm <= 0) {\n    return null;\n  }\n  \n  // More sophisticated sizing algorithm that considers individual measurements\n  // This ensures even small differences in measurements result in different sizes\n  \n  // Primary size based on chest (most important for tops)\n  // Using realistic size ranges based on actual human measurements\n  let primarySize = 'M';\n  if (chestCm < 80) primarySize = 'XXS';      // Very small frame\n  else if (chestCm < 85) primarySize = 'XS';   // Small frame\n  else if (chestCm < 90) primarySize = 'S';    // Small-medium frame\n  else if (chestCm < 95) primarySize = 'M';    // Medium frame (most common)\n  else if (chestCm < 100) primarySize = 'L';   // Large frame\n  else if (chestCm < 105) primarySize = 'XL';  // Extra large frame\n  else if (chestCm < 110) primarySize = 'XXL'; // 2X large frame\n  else if (chestCm < 115) primarySize = '3XL'; // 3X large frame\n  else primarySize = '4XL';                    // 4X large frame\n  \n  // Secondary adjustment based on waist-to-chest ratio\n  const waistChestRatio = waistCm / chestCm;\n  let sizeAdjustment = 0;\n  \n  if (waistChestRatio < 0.80) {\n    // Very slim build - go down one size\n    sizeAdjustment = -1;\n  } else if (waistChestRatio > 0.90) {\n    // Fuller build - go up one size\n    sizeAdjustment = 1;\n  }\n  \n  // Tertiary adjustment based on shoulder-to-chest ratio\n  const shoulderChestRatio = shoulderCm / chestCm;\n  if (shoulderChestRatio > 0.60) {\n    // Very broad shoulders - go up one size\n    sizeAdjustment += 1;\n  } else if (shoulderChestRatio < 0.50) {\n    // Very narrow shoulders - go down one size\n    sizeAdjustment -= 1;\n  }\n  \n  // Apply size adjustments\n  const sizeOrder = ['XXS', 'XS', 'S', 'M', 'L', 'XL', 'XXL', '3XL', '4XL'];\n  const currentIndex = sizeOrder.indexOf(primarySize);\n  const adjustedIndex = Math.max(0, Math.min(sizeOrder.length - 1, currentIndex + sizeAdjustment));\n  \n  const finalSize = sizeOrder[adjustedIndex];\n  \n  // Log the calculation for debugging\n  console.log(`Size Calculation:`, {\n    chestCm,\n    waistCm, \n    shoulderCm,\n    primarySize,\n    waistChestRatio: waistChestRatio.toFixed(3),\n    shoulderChestRatio: shoulderChestRatio.toFixed(3),\n    sizeAdjustment,\n    finalSize\n  });\n  \n  return finalSize;\n};\n\n// Optional style hint based on proportions (very light heuristic)\nconst styleHint = (chestCm, shoulderCm) => {\n  if (!chestCm || !shoulderCm) return \"\";\n  const ratio = chestCm / (shoulderCm || 1); // ~3–5 normal range\n  if (ratio < 3.6) return \"Try regular/relaxed fits.\";\n  if (ratio > 4.6) return \"Slim or tailored fits may suit better.\";\n  return \"Regular fit is likely comfortable.\";\n};\n\n// Add error handling wrapper at the top of the component\nconst MediaPipeErrorBoundary = ({ children }) => {\n  const [hasError, setHasError] = useState(false);\n  const [errorMessage, setErrorMessage] = useState('');\n\n  if (hasError) {\n    return (\n      <div className=\"min-h-screen bg-gradient-to-br from-gray-900 via-blue-900 to-indigo-900 flex items-center justify-center\">\n        <div className=\"bg-white/95 backdrop-blur-md rounded-3xl p-8 max-w-lg text-center\">\n          <div className=\"w-16 h-16 bg-red-100 rounded-full flex items-center justify-center mx-auto mb-4\">\n            <span className=\"text-2xl\">⚠️</span>\n          </div>\n          <h2 className=\"text-2xl font-bold text-gray-800 mb-4\">MediaPipe Error</h2>\n          <p className=\"text-gray-600 mb-6\">{errorMessage}</p>\n          <div className=\"space-y-3\">\n            <button \n              onClick={() => window.location.reload()}\n              className=\"w-full bg-blue-500 hover:bg-blue-600 text-white px-6 py-3 rounded-xl font-medium\"\n            >\n              🔄 Refresh Page\n            </button>\n            <button \n              onClick={() => setHasError(false)}\n              className=\"w-full bg-gray-200 hover:bg-gray-300 text-gray-700 px-6 py-3 rounded-xl font-medium\"\n            >\n              🚫 Dismiss\n            </button>\n          </div>\n        </div>\n      </div>\n    );\n  }\n\n  return (\n    <ErrorBoundary\n      onError={(error) => {\n        console.error('MediaPipe Error:', error);\n        setErrorMessage(error.message || 'An error occurred with MediaPipe');\n        setHasError(true);\n      }}\n    >\n      {children}\n    </ErrorBoundary>\n  );\n};\n\n// Simple ErrorBoundary component\nclass ErrorBoundary extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = { hasError: false };\n  }\n\n  static getDerivedStateFromError(error) {\n    return { hasError: true };\n  }\n\n  componentDidCatch(error, errorInfo) {\n    if (this.props.onError) {\n      this.props.onError(error);\n    }\n  }\n\n  render() {\n    if (this.state.hasError) {\n      return null; // Let parent handle the error display\n    }\n    return this.props.children;\n  }\n}\n\n/* ---------- Pose Landmarks for Upper Body ---------- */\nconst UPPER_BODY_LANDMARKS = [\n  [11, 12], // shoulders\n  [11, 13], [13, 15], // left arm\n  [12, 14], [14, 16], // right arm\n  [11, 23], [12, 24], // torso sides\n  [23, 24], // hips\n];\n\n/* ---------- Accurate Size Recommendation for Upper Body ---------- */\nconst recommendUpperBodySize = (measurements) => {\n  const { chestCm, shoulderCm, waistCm, armLengthCm, neckCm } = measurements;\n  \n  // Validate measurements\n  if (!chestCm || chestCm <= 0) return null;\n  \n  // Primary size based on CHEST (most important for tops)\n  // Using standard US/UK sizing charts\n  let primarySize = 'M';\n  \n  if (chestCm < 75) primarySize = 'XXS';      // Very small frame\n  else if (chestCm < 80) primarySize = 'XS';   // Small frame\n  else if (chestCm < 85) primarySize = 'S';    // Small-medium frame\n  else if (chestCm < 90) primarySize = 'M';    // Medium frame (most common)\n  else if (chestCm < 95) primarySize = 'L';    // Large frame\n  else if (chestCm < 100) primarySize = 'XL';  // Extra large frame\n  else if (chestCm < 105) primarySize = 'XXL'; // 2X large frame\n  else if (chestCm < 110) primarySize = '3XL'; // 3X large frame\n  else primarySize = '4XL';                    // 4X large frame\n  \n  // Secondary adjustment based on body proportions\n  let sizeAdjustment = 0;\n  \n  // Waist-to-chest ratio adjustment\n  if (waistCm && chestCm) {\n    const waistChestRatio = waistCm / chestCm;\n    if (waistChestRatio < 0.75) {\n      // Very slim build - go down one size\n      sizeAdjustment = -1;\n    } else if (waistChestRatio > 0.85) {\n      // Fuller build - go up one size\n      sizeAdjustment = 1;\n    }\n  }\n  \n  // Shoulder-to-chest ratio adjustment\n  if (shoulderCm && chestCm) {\n    const shoulderChestRatio = shoulderCm / chestCm;\n    if (shoulderChestRatio > 0.45) {\n      // Very broad shoulders - go up one size\n      sizeAdjustment += 1;\n    } else if (shoulderChestRatio < 0.35) {\n      // Very narrow shoulders - go down one size\n      sizeAdjustment -= 1;\n    }\n  }\n  \n  // Apply size adjustments\n  const sizeOrder = ['XXS', 'XS', 'S', 'M', 'L', 'XL', 'XXL', '3XL', '4XL'];\n  const currentIndex = sizeOrder.indexOf(primarySize);\n  const adjustedIndex = Math.max(0, Math.min(sizeOrder.length - 1, currentIndex + sizeAdjustment));\n  \n  const finalSize = sizeOrder[adjustedIndex];\n  \n  // Log the calculation for debugging\n  console.log(`Upper Body Size Calculation:`, {\n    measurements,\n    primarySize,\n    sizeAdjustment,\n    finalSize\n  });\n  \n  return finalSize;\n};\n\n// Simple pose drawing function\nconst drawPose = (ctx, landmarks, W, H) => {\n  if (!landmarks) return;\n  \n  // Draw shoulder line\n  const leftShoulder = landmarks[11];\n  const rightShoulder = landmarks[12];\n  \n  if (leftShoulder && rightShoulder && \n      (leftShoulder.visibility ?? 0) > 0.5 && \n      (rightShoulder.visibility ?? 0) > 0.5) {\n    \n    ctx.strokeStyle = \"#3B82F6\";\n    ctx.lineWidth = 4;\n    ctx.beginPath();\n    ctx.moveTo(leftShoulder.x * W, leftShoulder.y * H);\n    ctx.lineTo(rightShoulder.x * W, rightShoulder.y * H);\n    ctx.stroke();\n    \n    // Draw shoulder points\n    [leftShoulder, rightShoulder].forEach(point => {\n      ctx.fillStyle = \"#3B82F6\";\n      ctx.beginPath();\n      ctx.arc(point.x * W, point.y * H, 6, 0, Math.PI * 2);\n      ctx.fill();\n    });\n  }\n  \n  // Draw torso outline\n  const leftHip = landmarks[23];\n  const rightHip = landmarks[24];\n  \n  if (leftHip && rightHip && leftShoulder && rightShoulder &&\n      (leftHip.visibility ?? 0) > 0.5 && (rightHip.visibility ?? 0) > 0.5) {\n    \n    ctx.strokeStyle = \"#10B981\";\n    ctx.lineWidth = 3;\n    ctx.beginPath();\n    ctx.moveTo(leftShoulder.x * W, leftShoulder.y * H);\n    ctx.lineTo(leftHip.x * W, leftHip.y * H);\n    ctx.lineTo(rightHip.x * W, rightHip.y * H);\n    ctx.lineTo(rightShoulder.x * W, rightShoulder.y * H);\n    ctx.closePath();\n    ctx.stroke();\n  }\n};\n\nexport default function Measure() {\n  const videoRef = useRef(null);\n  const canvasRef = useRef(null);\n  const poseRef = useRef(null);\n  const camRef = useRef(null);\n\n  const [phase, setPhase] = useState(\"calibrate\");\n  const [status, setStatus] = useState(\"Hold an A4 sheet at chest level and match the bar width.\");\n  const [barPx, setBarPx] = useState(300);\n  const [cmPerPx, setCmPerPx] = useState(null);\n  const [locked, setLocked] = useState(false);\n  const [meas, setMeas] = useState(null);\n\n  // Measurement buffers for stability\n  const chestBuf = useRef([]);\n  const shoulderBuf = useRef([]);\n  const waistBuf = useRef([]);\n  const armBuf = useRef([]);\n  const neckBuf = useRef([]);\n\n  const STABILITY_FRAMES = 10;\n  const MOVEMENT_EPS = 0.02;\n\n  // Get distance between two points\n  const getDistance = useCallback((a, b) => {\n    if (!a || !b) return 0;\n    const dx = a.x - b.x, dy = a.y - b.y;\n    return Math.sqrt(dx*dx + dy*dy);\n  }, []);\n\n  // Calculate actual chest circumference from shoulder width\n  const calculateChestCircumference = (shoulderWidthCm) => {\n    // More accurate formula: chest circumference ≈ shoulder width × 2.2\n    // This accounts for the fact that chest goes around the body, not just across\n    return shoulderWidthCm * 2.2;\n  };\n\n  // Calculate waist circumference from hip width\n  const calculateWaistCircumference = (hipWidthCm) => {\n    // Waist is typically 0.85-0.95 of hip width\n    return hipWidthCm * 0.9;\n  };\n\n  // Calculate arm length from shoulder to wrist\n  const calculateArmLength = (shoulderPoint, wristPoint, cmPerPx, W, H) => {\n    if (!shoulderPoint || !wristPoint) return null;\n    \n    const shoulderPx = Math.sqrt(\n      Math.pow((shoulderPoint.x - wristPoint.x) * W, 2) + \n      Math.pow((shoulderPoint.y - wristPoint.y) * H, 2)\n    );\n    \n    return shoulderPx * cmPerPx;\n  };\n\n  // Calculate neck circumference (approximate from shoulder width)\n  const calculateNeckCircumference = (shoulderWidthCm) => {\n    // Neck is typically 0.25-0.30 of shoulder width\n    return shoulderWidthCm * 0.28;\n  };\n\n  // Camera management functions\n  const startCamera = useCallback(async (pose) => {\n    if (!videoRef.current || !pose) return;\n    \n    const video = videoRef.current;\n    \n    // Prevent multiple simultaneous start attempts\n    if (camRef.current) return;\n\n    try {\n      // Stop any existing video tracks first\n      if (video.srcObject) {\n        video.srcObject.getTracks().forEach(track => track.stop());\n        video.srcObject = null;\n      }\n\n      // Wait a bit for cleanup\n      await new Promise(resolve => setTimeout(resolve, 100));\n\n      // Get new camera stream\n      const stream = await navigator.mediaDevices.getUserMedia({ \n        video: { \n          width: 1280, \n          height: 720,\n          facingMode: 'user'\n        } \n      });\n      \n      // Set video source and wait for it to be ready\n      video.srcObject = stream;\n      \n      // Wait for video to be ready before playing\n      await new Promise((resolve, reject) => {\n        video.onloadedmetadata = resolve;\n        video.onerror = reject;\n        // Timeout after 5 seconds\n        setTimeout(() => reject(new Error('Video load timeout')), 5000);\n      });\n\n      // Start playing video\n      try {\n        await video.play();\n      } catch (playError) {\n        console.warn('Video play failed, trying alternative method:', playError);\n        // Fallback: try to play without await\n        video.play().catch(e => console.warn('Fallback play failed:', e));\n      }\n      \n      // Create and start camera for pose detection\n      const cameraInstance = new Camera(video, {\n        onFrame: async () => {\n          try {\n            await pose.send({ image: video });\n          } catch (error) {\n            console.warn('Pose detection error:', error);\n          }\n        },\n        width: 1280,\n        height: 720\n      });\n      \n      cameraInstance.start();\n      camRef.current = cameraInstance;\n      \n      console.log('Camera started successfully');\n      \n    } catch (error) {\n      console.error('Camera start error:', error);\n      setStatus('Camera error: ' + (error.message || 'Failed to start camera'));\n    }\n  }, []);\n\n  const stopCamera = useCallback(() => {\n    try {\n      if (camRef.current) {\n        camRef.current.stop();\n        camRef.current = null;\n      }\n      if (videoRef.current && videoRef.current.srcObject) {\n        videoRef.current.srcObject.getTracks().forEach(track => track.stop());\n        videoRef.current.srcObject = null;\n      }\n      console.log('Camera stopped successfully');\n    } catch (error) {\n      console.warn('Camera stop error:', error);\n    }\n  }, []);\n\n  useEffect(() => {\n    if (!videoRef.current || !canvasRef.current) return;\n\n    const video = videoRef.current;\n    const canvas = canvasRef.current;\n    const ctx = canvas.getContext('2d');\n\n    // Set canvas size to match video\n    canvas.width = 1280;\n    canvas.height = 720;\n\n    const pose = new Pose({\n      locateFile: (file) => {\n        return `https://cdn.jsdelivr.net/npm/@mediapipe/pose/${file}`;\n      }\n    });\n\n    pose.setOptions({\n      modelComplexity: 1,\n      smoothLandmarks: true,\n      enableSegmentation: false,\n      smoothSegmentation: false,\n      minDetectionConfidence: 0.5,\n      minTrackingConfidence: 0.5\n    });\n\n    let isStarting = false;\n\n    pose.onResults((res) => {\n      if (!res.poseLandmarks) {\n        setStatus(\"Detecting body...\");\n        return;\n      }\n\n      const W = canvas.width, H = canvas.height;\n      ctx.clearRect(0, 0, W, H);\n      \n      // Draw pose\n      drawPose(ctx, res.poseLandmarks, W, H);\n\n      const landmarks = res.poseLandmarks;\n      const vis = (i) => (landmarks[i]?.visibility ?? 0) > 0.5;\n\n      // Check if key points are visible\n      const shouldersOK = vis(11) && vis(12);\n      const hipsOK = vis(23) && vis(24);\n      const wristsOK = vis(15) && vis(16);\n\n      if (!shouldersOK || !hipsOK) {\n        setStatus(\"Show shoulders and upper torso clearly.\");\n        return;\n      }\n\n      if (phase === \"calibrate\") {\n        setStatus(\"Adjust bar → Set calibration.\");\n        return;\n      }\n\n      if (!cmPerPx) {\n        setStatus(\"Click Set calibration first.\");\n        return;\n      }\n\n      // Calculate measurements\n      const leftShoulder = landmarks[11];\n      const rightShoulder = landmarks[12];\n      const leftHip = landmarks[23];\n      const rightHip = landmarks[24];\n      const leftWrist = landmarks[15];\n      const rightWrist = landmarks[16];\n\n      // Shoulder width\n      const shoulderPx = Math.abs((leftShoulder.x - rightShoulder.x) * W);\n      const shoulderCm = shoulderPx * cmPerPx;\n\n      // Hip width (for waist calculation)\n      const hipPx = Math.abs((leftHip.x - rightHip.x) * W);\n      const hipCm = hipPx * cmPerPx;\n\n      // Calculate all measurements\n      const chestCm = calculateChestCircumference(shoulderCm);\n      const waistCm = calculateWaistCircumference(hipCm);\n      const armLengthCm = calculateArmLength(leftShoulder, leftWrist, cmPerPx, W, H);\n      const neckCm = calculateNeckCircumference(shoulderCm);\n\n      // Store in buffers for stability\n      const pushToBuffer = (buffer, value) => {\n        if (value && value > 0) {\n          buffer.current.push(value);\n          if (buffer.current.length > STABILITY_FRAMES) {\n            buffer.current.shift();\n          }\n        }\n      };\n\n      pushToBuffer(chestBuf, chestCm);\n      pushToBuffer(shoulderBuf, shoulderCm);\n      pushToBuffer(waistBuf, waistCm);\n      pushToBuffer(armBuf, armLengthCm);\n      pushToBuffer(neckBuf, neckCm);\n\n      // Check stability\n      const isStable = chestBuf.current.length >= STABILITY_FRAMES && \n                       shoulderBuf.current.length >= STABILITY_FRAMES;\n\n      if (isStable) {\n        // Get median values for stability\n        const getMedian = (buffer) => {\n          if (buffer.current.length === 0) return null;\n          const sorted = [...buffer.current].sort((a, b) => a - b);\n          const mid = Math.floor(sorted.length / 2);\n          return sorted.length % 2 === 0 \n            ? (sorted[mid - 1] + sorted[mid]) / 2 \n            : sorted[mid];\n        };\n\n        const stableMeasurements = {\n          chestCm: Number(getMedian(chestBuf).toFixed(1)),\n          shoulderCm: Number(getMedian(shoulderBuf).toFixed(1)),\n          waistCm: Number(getMedian(waistBuf).toFixed(1)),\n          armLengthCm: getMedian(armBuf) ? Number(getMedian(armBuf).toFixed(1)) : null,\n          neckCm: Number(getMedian(neckBuf).toFixed(1))\n        };\n\n        setMeas(stableMeasurements);\n        setLocked(true);\n        setPhase(\"locked\");\n        setStatus(\"Measurements locked! ✅\");\n        stopCamera();\n      } else {\n        setStatus(\"Hold still for stable measurements...\");\n      }\n    });\n\n    // Start camera when ready\n    const startWhenReady = () => {\n      if (video.readyState >= 2) { // HAVE_CURRENT_DATA\n        startCamera(pose);\n      } else {\n        video.addEventListener('canplay', () => startCamera(pose), { once: true });\n      }\n    };\n\n    startWhenReady();\n    poseRef.current = pose;\n\n    return () => {\n      stopCamera();\n      if (poseRef.current) {\n        poseRef.current.close();\n      }\n      // Additional cleanup to prevent video play errors\n      if (video.srcObject) {\n        video.srcObject.getTracks().forEach(track => track.stop());\n        video.srcObject = null;\n      }\n    };\n  }, [phase, cmPerPx, getDistance]);\n\n  const setCalibration = () => {\n    if (barPx < 40) return;\n    setCmPerPx(A4_WIDTH_CM / barPx);\n    setPhase(\"measure\");\n    setStatus(\"Calibration set. Stand centered with shoulders visible.\");\n    \n    // Reset buffers\n    chestBuf.current = [];\n    shoulderBuf.current = [];\n    waistBuf.current = [];\n    armBuf.current = [];\n    neckBuf.current = [];\n  };\n\n  const retake = () => {\n    setLocked(false);\n    setMeas(null);\n    setPhase(\"measure\");\n    setStatus(\"Stand centered; hold still for measurements.\");\n    \n    // Reset buffers\n    chestBuf.current = [];\n    shoulderBuf.current = [];\n    waistBuf.current = [];\n    armBuf.current = [];\n    neckBuf.current = [];\n\n    // Restart camera after a short delay\n    setTimeout(() => {\n      if (poseRef.current && !locked) {\n        startCamera(poseRef.current);\n      }\n    }, 500);\n  };\n\n  const recalibrate = () => {\n    setLocked(false);\n    setMeas(null);\n    setPhase(\"calibrate\");\n    setStatus(\"Hold an A4 sheet at chest level and match the bar width.\");\n    \n    // Reset buffers\n    chestBuf.current = [];\n    shoulderBuf.current = [];\n    waistBuf.current = [];\n    armBuf.current = [];\n    neckBuf.current = [];\n\n    // Restart camera after a short delay\n    setTimeout(() => {\n      if (poseRef.current && !locked) {\n        startCamera(poseRef.current);\n      }\n    }, 500);\n  };\n\n  // Get status icon\n  const getStatusIcon = () => {\n    if (phase === \"locked\") return <span className=\"text-emerald-500 text-xl\">✅</span>;\n    if (phase === \"measure\") return <Activity className=\"w-5 h-5 text-blue-500 animate-pulse\" />;\n    return <Target className=\"w-5 h-5 text-amber-500\" />;\n  };\n\n  // Get phase color\n  const getPhaseColor = () => {\n    if (phase === \"locked\") return \"from-emerald-500 to-green-500\";\n    if (phase === \"measure\") return \"from-blue-500 to-cyan-500\";\n    return \"from-amber-500 to-orange-500\";\n  };\n\n  return (\n    <MediaPipeErrorBoundary>\n      <div className=\"min-h-screen bg-gradient-to-br from-gray-900 via-blue-900 to-indigo-900 relative overflow-hidden\">\n        {/* Background */}\n        <div className=\"absolute inset-0\">\n          <div className=\"absolute top-10 left-10 w-72 h-72 bg-blue-500/10 rounded-full blur-3xl animate-pulse\"></div>\n          <div className=\"absolute bottom-10 right-10 w-96 h-96 bg-emerald-500/10 rounded-full blur-3xl animate-pulse delay-1000\"></div>\n        </div>\n\n        <div className=\"relative z-10 flex flex-col items-center min-h-screen\">\n          {/* Header */}\n          <div className=\"w-full max-w-7xl flex items-center justify-between px-6 py-6\">\n            <div className=\"flex items-center space-x-4\">\n              <div className=\"w-12 h-12 bg-gradient-to-r from-blue-500 to-emerald-500 rounded-2xl flex items-center justify-center shadow-lg\">\n                <Sparkles className=\"w-7 h-7 text-white\" />\n              </div>\n              <div>\n                <h1 className=\"text-2xl font-bold text-white\">AI Fashion Fit</h1>\n                <p className=\"text-sm text-blue-200\">Upper Body Measurement System</p>\n              </div>\n            </div>\n            \n            {/* Status Badge */}\n            <div className=\"flex items-center space-x-3\">\n              <div className={`bg-gradient-to-r ${getPhaseColor()} rounded-full px-6 py-3 shadow-lg backdrop-blur-sm border border-white/10`}>\n                <div className=\"flex items-center space-x-3 text-white\">\n                  {getStatusIcon()}\n                  <span className=\"font-medium text-sm\">{status}</span>\n                </div>\n              </div>\n            </div>\n          </div>\n\n          {/* Camera Section */}\n          <div className=\"w-full max-w-6xl px-6 flex-1 flex items-center\">\n            <div className=\"relative w-full bg-black/20 backdrop-blur-lg rounded-3xl overflow-hidden shadow-2xl border border-white/10\">\n              <div className=\"relative aspect-video\">\n                <video ref={videoRef} className=\"absolute inset-0 w-full h-full object-contain bg-black rounded-3xl\" autoPlay muted playsInline />\n                <canvas ref={canvasRef} className=\"absolute inset-0 w-full h-full object-contain pointer-events-none\" />\n\n                {/* Calibration UI */}\n                {phase === \"calibrate\" && (\n                  <div className=\"absolute bottom-6 left-1/2 transform -translate-x-1/2\">\n                    <div className=\"bg-white/95 backdrop-blur-md rounded-2xl px-6 py-4 shadow-2xl border border-white/20\">\n                      <div className=\"flex items-center space-x-4\">\n                        <div className=\"flex items-center space-x-2\">\n                          <Target className=\"w-5 h-5 text-amber-600\" />\n                          <span className=\"text-sm font-medium text-gray-700\">A4 width calibration</span>\n                        </div>\n                        <input \n                          type=\"range\" \n                          min={120} \n                          max={900} \n                          value={barPx} \n                          onChange={(e) => setBarPx(Number(e.target.value))} \n                          className=\"w-64 accent-blue-500\"\n                        />\n                        <button \n                          onClick={setCalibration} \n                          className=\"bg-gradient-to-r from-blue-500 to-emerald-500 hover:from-blue-600 hover:to-emerald-600 text-white px-6 py-2 rounded-xl font-medium transition-all duration-300 transform hover:scale-105 shadow-lg flex items-center space-x-2\"\n                        >\n                          <span className=\"text-white text-lg\">✅</span>\n                          <span>Set Calibration</span>\n                        </button>\n                      </div>\n                    </div>\n                  </div>\n                )}\n              </div>\n            </div>\n          </div>\n\n          {/* Instructions */}\n          <div className=\"w-full max-w-4xl px-6 py-4\">\n            <div className=\"bg-white/10 backdrop-blur-md rounded-2xl p-6 border border-white/20\">\n              <div className=\"text-center text-white\">\n                <div className=\"flex items-center justify-center space-x-2 mb-3\">\n                  <CameraIcon className=\"w-5 h-5 text-blue-300\" />\n                  <h3 className=\"font-semibold\">Instructions</h3>\n                </div>\n                <div className=\"text-sm text-white/80 space-y-2\">\n                  {phase === \"calibrate\" && (\n                    <p>📄 Hold an A4 sheet at chest level and adjust the bar to match its width for accurate calibration.</p>\n                  )}\n                  {phase === \"measure\" && (\n                    <p>🧍 Stand straight with arms slightly away from your body. Show shoulders and upper torso clearly.</p>\n                  )}\n                  {phase === \"locked\" && (\n                    <p>✅ Upper body measurements captured successfully! You can retake if needed or get recommendations.</p>\n                  )}\n                </div>\n              </div>\n            </div>\n          </div>\n\n          {/* Results Display */}\n          {phase === \"locked\" && meas && (\n            <div className=\"w-full max-w-4xl px-6 py-6\">\n              <div className=\"bg-white/95 backdrop-blur-md rounded-2xl p-6 border border-gray-200 shadow-xl\">\n                <div className=\"text-center text-gray-800\">\n                  <h3 className=\"text-xl font-bold mb-4\">📊 Upper Body Measurements</h3>\n                  \n                  {/* Measurements Grid */}\n                  <div className=\"grid grid-cols-1 md:grid-cols-3 gap-4 mb-6\">\n                    <div className=\"bg-blue-50 rounded-xl p-4 border border-blue-200\">\n                      <div className=\"text-2xl font-bold text-blue-600\">{meas.chestCm?.toFixed(1) || 'N/A'}</div>\n                      <div className=\"text-sm text-blue-500\">Chest (cm)</div>\n                    </div>\n                    <div className=\"bg-emerald-50 rounded-xl p-4 border border-emerald-200\">\n                      <div className=\"text-2xl font-bold text-emerald-600\">{meas.shoulderCm?.toFixed(1) || 'N/A'}</div>\n                      <div className=\"text-sm text-emerald-500\">Shoulder (cm)</div>\n                    </div>\n                    <div className=\"bg-purple-50 rounded-xl p-4 border border-purple-200\">\n                      <div className=\"text-2xl font-bold text-purple-600\">{meas.waistCm?.toFixed(1) || 'N/A'}</div>\n                      <div className=\"text-sm text-purple-500\">Waist (cm)</div>\n                    </div>\n                  </div>\n\n                  {/* Additional Measurements */}\n                  <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4 mb-6\">\n                    <div className=\"bg-orange-50 rounded-xl p-4 border border-orange-200\">\n                      <div className=\"text-xl font-bold text-orange-600\">{meas.armLengthCm?.toFixed(1) || 'N/A'}</div>\n                      <div className=\"text-sm text-orange-500\">Arm Length (cm)</div>\n                    </div>\n                    <div className=\"bg-pink-50 rounded-xl p-4 border border-pink-200\">\n                      <div className=\"text-xl font-bold text-pink-600\">{meas.neckCm?.toFixed(1) || 'N/A'}</div>\n                      <div className=\"text-sm text-pink-500\">Neck (cm)</div>\n                    </div>\n                  </div>\n\n                  {/* Size Recommendation */}\n                  <div className=\"bg-gradient-to-r from-blue-50 to-emerald-50 rounded-xl p-4 mb-6 border border-blue-200\">\n                    <div className=\"text-lg font-semibold text-gray-700 mb-2\">Recommended Upper Body Size</div>\n                    <div className=\"text-3xl font-bold bg-gradient-to-r from-blue-600 to-emerald-600 bg-clip-text text-transparent\">\n                      {recommendUpperBodySize(meas)}\n                    </div>\n                    <div className=\"text-sm text-gray-600 mt-2\">\n                      Based on chest, shoulder, waist, arm length, and neck measurements\n                    </div>\n                  </div>\n\n                  {/* Action Buttons */}\n                  <div className=\"flex flex-col sm:flex-row gap-3 justify-center\">\n                    <button \n                      onClick={retake}\n                      className=\"bg-gray-200 hover:bg-gray-300 text-gray-700 px-6 py-3 rounded-xl font-medium transition-all duration-300 border-2 border-gray-300\"\n                    >\n                      🔄 Retake\n                    </button>\n                    <button \n                      onClick={recalibrate}\n                      className=\"bg-blue-100 hover:bg-blue-200 text-blue-700 px-6 py-3 rounded-xl font-medium transition-all duration-300 border-2 border-blue-300\"\n                    >\n                      🎯 Recalibrate\n                    </button>\n                    <button \n                      onClick={() => {\n                        const recommendedSize = recommendUpperBodySize(meas);\n                        if (recommendedSize) {\n                          const measurementData = encodeURIComponent(JSON.stringify({\n                            size: recommendedSize,\n                            gender: 'Men',\n                            measurements: meas\n                          }));\n                          window.location.href = `/recommendations?data=${measurementData}`;\n                        }\n                      }}\n                      className=\"bg-gradient-to-r from-purple-500 to-pink-500 hover:from-purple-600 hover:to-pink-600 text-white px-6 py-3 rounded-xl font-medium transition-all duration-300 shadow-lg\"\n                    >\n                      ✨ Get Recommendations\n                    </button>\n                  </div>\n                </div>\n              </div>\n            </div>\n          )}\n        </div>\n      </div>\n    </MediaPipeErrorBoundary>\n  );\n}"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}