{"ast":null,"code":"var _jsxFileName = \"/Users/dhirajbalayar/Desktop/fashion/frontend/src/pages/Measure.jsx\",\n  _s = $RefreshSig$(),\n  _s2 = $RefreshSig$();\n// src/pages/Measure.jsx\nimport React, { useRef, useEffect, useState, useCallback } from \"react\";\nimport { Pose } from \"@mediapipe/pose\";\nimport { Camera } from \"@mediapipe/camera_utils\";\nimport { Camera as CameraIcon, Sparkles, Activity, Target, RotateCcw, Download } from 'lucide-react';\n\n/* ---------- Calibration ---------- */\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst A4_WIDTH_CM = 21.0; // reference width\nconst CHEST_MULTIPLIER = 1.75; // shoulder flat → chest circumference (tune 1.70–1.85)\nconst UPPER_WAIST_FACTOR = 0.90; // hip width ≈ a bit wider than upper waist\n\n/* ---------- Overlay helpers ---------- */\nconst UPPER = [[0, 1], [1, 2], [2, 3], [3, 7], [0, 11], [0, 12], [11, 13], [13, 15], [12, 14], [14, 16], [11, 12], [11, 23], [12, 24]];\nconst LOWER = [[23, 25], [25, 27], [27, 31], [24, 26], [26, 28], [28, 32], [23, 24]];\nconst drawSeg = (ctx, lm, a, b, color, width, W, H) => {\n  var _A$visibility, _B$visibility;\n  const A = lm[a],\n    B = lm[b];\n  if (!A || !B) return;\n  if (((_A$visibility = A.visibility) !== null && _A$visibility !== void 0 ? _A$visibility : 0) < 0.4 || ((_B$visibility = B.visibility) !== null && _B$visibility !== void 0 ? _B$visibility : 0) < 0.4) return;\n  ctx.strokeStyle = color;\n  ctx.lineWidth = width;\n  ctx.beginPath();\n  ctx.moveTo(A.x * W, A.y * H);\n  ctx.lineTo(B.x * W, B.y * H);\n  ctx.stroke();\n};\nconst drawBBox = (ctx, lm, W, H, color = \"rgba(0,255,0,0.9)\") => {\n  const pts = lm.filter(p => {\n    var _p$visibility;\n    return ((_p$visibility = p === null || p === void 0 ? void 0 : p.visibility) !== null && _p$visibility !== void 0 ? _p$visibility : 0) > 0.4;\n  });\n  if (!pts.length) return;\n  const xs = pts.map(p => p.x * W),\n    ys = pts.map(p => p.y * H);\n  const minX = Math.max(0, Math.min(...xs)),\n    maxX = Math.min(W, Math.max(...xs));\n  const minY = Math.max(0, Math.min(...ys)),\n    maxY = Math.min(H, Math.max(...ys));\n  const pad = 8;\n  ctx.strokeStyle = color;\n  ctx.lineWidth = 3;\n  ctx.strokeRect(minX - pad, minY - pad, maxX - minX + pad * 2, maxY - minY + pad * 2);\n};\n\n/* ---------- Size recommendation (using all three measurements) ---------- */\nconst recommendTopSize = (chestCm, waistCm, shoulderCm) => {\n  if (!chestCm || !waistCm || !shoulderCm || chestCm <= 0 || waistCm <= 0 || shoulderCm <= 0) {\n    return null;\n  }\n\n  // Population-based sizing algorithm using statistical human measurement data\n  // Based on research from clothing industry standards and anthropometric studies\n\n  // Statistical size distribution (percentiles from human measurement studies)\n  const SIZE_DISTRIBUTION = {\n    'XXS': {\n      min: 70,\n      max: 79,\n      percentile: 5,\n      description: 'Very small frame (5% of population)'\n    },\n    'XS': {\n      min: 80,\n      max: 84,\n      percentile: 15,\n      description: 'Small frame (10% of population)'\n    },\n    'S': {\n      min: 85,\n      max: 89,\n      percentile: 30,\n      description: 'Small-medium frame (15% of population)'\n    },\n    'M': {\n      min: 90,\n      max: 94,\n      percentile: 50,\n      description: 'Medium frame (20% of population - most common)'\n    },\n    'L': {\n      min: 95,\n      max: 99,\n      percentile: 70,\n      description: 'Large frame (20% of population)'\n    },\n    'XL': {\n      min: 100,\n      max: 104,\n      percentile: 85,\n      description: 'Extra large frame (15% of population)'\n    },\n    'XXL': {\n      min: 105,\n      max: 109,\n      percentile: 95,\n      description: '2X large frame (10% of population)'\n    },\n    '3XL': {\n      min: 110,\n      max: 114,\n      percentile: 98,\n      description: '3X large frame (3% of population)'\n    },\n    '4XL': {\n      min: 115,\n      max: 120,\n      percentile: 100,\n      description: '4X large frame (2% of population)'\n    }\n  };\n\n  // Primary size based on chest measurement (most reliable indicator)\n  let primarySize = 'M';\n  for (const [size, data] of Object.entries(SIZE_DISTRIBUTION)) {\n    if (chestCm >= data.min && chestCm <= data.max) {\n      primarySize = size;\n      break;\n    }\n  }\n\n  // Body type classification based on proportions\n  const bodyType = classifyBodyType(chestCm, waistCm, shoulderCm);\n\n  // Size adjustment based on body type and proportions\n  let sizeAdjustment = 0;\n\n  // Waist-to-chest ratio adjustment (body shape)\n  const waistChestRatio = waistCm / chestCm;\n  if (waistChestRatio < 0.75) {\n    // Ectomorph (slim) - consider going down one size\n    sizeAdjustment -= 0.5;\n  } else if (waistChestRatio > 0.90) {\n    // Endomorph (full) - consider going up one size\n    sizeAdjustment += 0.5;\n  }\n\n  // Shoulder-to-chest ratio adjustment (upper body build)\n  const shoulderChestRatio = shoulderCm / chestCm;\n  if (shoulderChestRatio > 0.58) {\n    // Broad shoulders (athletic) - consider going up one size\n    sizeAdjustment += 0.5;\n  } else if (shoulderChestRatio < 0.48) {\n    // Narrow shoulders - consider going down one size\n    sizeAdjustment -= 0.5;\n  }\n\n  // Apply size adjustments with bounds checking\n  const sizeOrder = ['XXS', 'XS', 'S', 'M', 'L', 'XL', 'XXL', '3XL', '4XL'];\n  const currentIndex = sizeOrder.indexOf(primarySize);\n  const adjustedIndex = Math.max(0, Math.min(sizeOrder.length - 1, currentIndex + Math.round(sizeAdjustment)));\n  const finalSize = sizeOrder[adjustedIndex];\n\n  // Calculate confidence score for this recommendation\n  const confidence = calculateSizeConfidence(chestCm, waistCm, shoulderCm, finalSize);\n\n  // Log detailed calculation for debugging and research\n  console.log(`Enhanced Size Calculation:`, {\n    measurements: {\n      chestCm,\n      waistCm,\n      shoulderCm\n    },\n    primarySize,\n    bodyType,\n    proportions: {\n      waistChestRatio: waistChestRatio.toFixed(3),\n      shoulderChestRatio: shoulderChestRatio.toFixed(3)\n    },\n    adjustments: {\n      sizeAdjustment,\n      finalSize\n    },\n    confidence,\n    populationData: SIZE_DISTRIBUTION[finalSize]\n  });\n  return finalSize;\n};\n\n// Body type classification based on anthropometric research\nconst classifyBodyType = (chestCm, waistCm, shoulderCm) => {\n  const waistChestRatio = waistCm / chestCm;\n  const shoulderChestRatio = shoulderCm / chestCm;\n  if (waistChestRatio < 0.75 && shoulderChestRatio < 0.52) {\n    return 'Ectomorph (Slim)';\n  } else if (waistChestRatio > 0.90 && shoulderChestRatio > 0.58) {\n    return 'Endomorph (Full)';\n  } else if (shoulderChestRatio > 0.55 && waistChestRatio < 0.85) {\n    return 'Mesomorph (Athletic)';\n  } else {\n    return 'Balanced';\n  }\n};\n\n// Calculate confidence in size recommendation\nconst calculateSizeConfidence = (chestCm, waistCm, shoulderCm, recommendedSize) => {\n  let confidence = 0.8; // Base confidence\n\n  // Higher confidence for measurements in middle of size ranges\n  const sizeRanges = {\n    'XXS': [70, 79],\n    'XS': [80, 84],\n    'S': [85, 89],\n    'M': [90, 94],\n    'L': [95, 99],\n    'XL': [100, 104],\n    'XXL': [105, 109],\n    '3XL': [110, 114],\n    '4XL': [115, 120]\n  };\n  const range = sizeRanges[recommendedSize];\n  if (range) {\n    const midPoint = (range[0] + range[1]) / 2;\n    const distanceFromMid = Math.abs(chestCm - midPoint);\n    const rangeWidth = range[1] - range[0];\n    const positionConfidence = 1 - distanceFromMid / (rangeWidth / 2);\n    confidence += positionConfidence * 0.2;\n  }\n  return Math.min(1, Math.max(0, confidence));\n};\n\n// Optional style hint based on proportions (very light heuristic)\nconst styleHint = (chestCm, shoulderCm) => {\n  if (!chestCm || !shoulderCm) return \"\";\n  const ratio = chestCm / (shoulderCm || 1); // ~3–5 normal range\n  if (ratio < 3.6) return \"Try regular/relaxed fits.\";\n  if (ratio > 4.6) return \"Slim or tailored fits may suit better.\";\n  return \"Regular fit is likely comfortable.\";\n};\n\n/* ---------- Enhanced Calibration System ---------- */\nconst CALIBRATION_OBJECTS = [{\n  name: 'A4 Paper',\n  width: 21.0,\n  height: 29.7,\n  description: 'Standard A4 paper (21.0 × 29.7 cm)'\n}, {\n  name: 'Credit Card',\n  width: 8.56,\n  height: 5.4,\n  description: 'Standard credit card (8.56 × 5.4 cm)'\n}, {\n  name: 'iPhone',\n  width: 7.15,\n  height: 14.7,\n  description: 'iPhone 14 Pro (7.15 × 14.7 cm)'\n}];\nconst CALIBRATION_THRESHOLD = 0.8; // Minimum calibration quality to proceed\n\n// Enhanced calibration validation\nconst validateCalibration = (measuredPx, expectedCm, cmPerPx) => {\n  const measuredCm = measuredPx * cmPerPx;\n  const error = Math.abs(measuredCm - expectedCm);\n  const accuracy = Math.max(0, 1 - error / expectedCm);\n  return {\n    accuracy,\n    error,\n    measuredCm,\n    expectedCm\n  };\n};\n\n// Calculate overall calibration quality\nconst calculateCalibrationQuality = calibrationResults => {\n  if (calibrationResults.length === 0) return 0;\n  const totalAccuracy = calibrationResults.reduce((sum, result) => sum + result.accuracy, 0);\n  const averageAccuracy = totalAccuracy / calibrationResults.length;\n\n  // Bonus for multiple successful calibrations\n  const bonus = calibrationResults.length >= 2 ? 0.1 : 0;\n  return Math.min(1, averageAccuracy + bonus);\n};\n\n/* ---------- Enhanced Measurement Validation System ---------- */\nconst MEASUREMENT_QUALITY_THRESHOLD = 0.7; // Minimum quality to accept measurements\n\n// Validate realistic human proportions\nconst validateHumanProportions = (chestCm, waistCm, shoulderCm) => {\n  const issues = [];\n  let qualityScore = 1.0;\n\n  // Chest to shoulder ratio (should be 2.5-4.5 for humans)\n  const chestShoulderRatio = chestCm / shoulderCm;\n  if (chestShoulderRatio < 2.5) {\n    issues.push(`Chest/shoulder ratio too low: ${chestShoulderRatio.toFixed(2)} (expected 2.5-4.5)`);\n    qualityScore -= 0.3;\n  } else if (chestShoulderRatio > 4.5) {\n    issues.push(`Chest/shoulder ratio too high: ${chestShoulderRatio.toFixed(2)} (expected 2.5-4.5)`);\n    qualityScore -= 0.3;\n  }\n\n  // Waist to chest ratio (should be 0.7-0.95 for humans)\n  const waistChestRatio = waistCm / chestCm;\n  if (waistChestRatio < 0.7) {\n    issues.push(`Waist/chest ratio too low: ${waistChestRatio.toFixed(2)} (expected 0.7-0.95)`);\n    qualityScore -= 0.2;\n  } else if (waistChestRatio > 0.95) {\n    issues.push(`Waist/chest ratio too high: ${waistChestRatio.toFixed(2)} (expected 0.7-0.95)`);\n    qualityScore -= 0.2;\n  }\n\n  // Absolute measurement ranges (realistic human limits)\n  if (chestCm < 60 || chestCm > 140) {\n    issues.push(`Chest measurement unrealistic: ${chestCm}cm (expected 60-140cm)`);\n    qualityScore -= 0.4;\n  }\n  if (shoulderCm < 30 || shoulderCm > 70) {\n    issues.push(`Shoulder measurement unrealistic: ${shoulderCm}cm (expected 30-70cm)`);\n    qualityScore -= 0.4;\n  }\n  if (waistCm < 50 || waistCm > 120) {\n    issues.push(`Waist measurement unrealistic: ${waistCm}cm (expected 50-120cm)`);\n    qualityScore -= 0.3;\n  }\n  return {\n    qualityScore: Math.max(0, qualityScore),\n    issues,\n    isValid: qualityScore >= MEASUREMENT_QUALITY_THRESHOLD\n  };\n};\n\n// Enhanced measurement quality scoring\nconst calculateMeasurementQuality = (measurements, stabilityData) => {\n  const {\n    chestCm,\n    shoulderCm,\n    upperWaistCm,\n    quality\n  } = measurements;\n\n  // Proportion validation\n  const proportionValidation = validateHumanProportions(chestCm, upperWaistCm, shoulderCm);\n\n  // Stability scoring\n  const stabilityScore = Math.max(0, 1 - quality.spreadCm / 3); // 3cm max spread\n\n  // Frame count scoring\n  const frameScore = Math.min(1, quality.frames / 15); // 15 frames = perfect\n\n  // Overall quality calculation\n  const overallQuality = proportionValidation.qualityScore * 0.5 + stabilityScore * 0.3 + frameScore * 0.2;\n  return {\n    overallQuality: Math.round(overallQuality * 100) / 100,\n    proportionQuality: Math.round(proportionValidation.qualityScore * 100) / 100,\n    stabilityQuality: Math.round(stabilityScore * 100) / 100,\n    frameQuality: Math.round(frameScore * 100) / 100,\n    issues: proportionValidation.issues,\n    isValid: proportionValidation.isValid && overallQuality >= MEASUREMENT_QUALITY_THRESHOLD\n  };\n};\n\n// Add error handling wrapper at the top of the component\nconst MediaPipeErrorBoundary = ({\n  children\n}) => {\n  _s();\n  const [hasError, setHasError] = useState(false);\n  const [errorMessage, setErrorMessage] = useState('');\n  if (hasError) {\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"min-h-screen bg-gradient-to-br from-gray-900 via-blue-900 to-indigo-900 flex items-center justify-center\",\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"bg-white/95 backdrop-blur-md rounded-3xl p-8 max-w-lg text-center\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"w-16 h-16 bg-red-100 rounded-full flex items-center justify-center mx-auto mb-4\",\n          children: /*#__PURE__*/_jsxDEV(\"span\", {\n            className: \"text-2xl\",\n            children: \"\\u26A0\\uFE0F\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 295,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 294,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"h2\", {\n          className: \"text-2xl font-bold text-gray-800 mb-4\",\n          children: \"MediaPipe Error\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 297,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n          className: \"text-gray-600 mb-6\",\n          children: errorMessage\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 298,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"space-y-3\",\n          children: [/*#__PURE__*/_jsxDEV(\"button\", {\n            onClick: () => window.location.reload(),\n            className: \"w-full bg-blue-500 hover:bg-blue-600 text-white px-6 py-3 rounded-xl font-medium\",\n            children: \"\\uD83D\\uDD04 Refresh Page\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 300,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n            onClick: () => setHasError(false),\n            className: \"w-full bg-gray-200 hover:bg-gray-300 text-gray-700 px-6 py-3 rounded-xl font-medium\",\n            children: \"\\uD83D\\uDEAB Dismiss\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 306,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 299,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 293,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 292,\n      columnNumber: 7\n    }, this);\n  }\n  return /*#__PURE__*/_jsxDEV(ErrorBoundary, {\n    onError: error => {\n      console.error('MediaPipe Error:', error);\n      setErrorMessage(error.message || 'An error occurred with MediaPipe');\n      setHasError(true);\n    },\n    children: children\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 319,\n    columnNumber: 5\n  }, this);\n};\n\n// Simple ErrorBoundary component\n_s(MediaPipeErrorBoundary, \"xvQka5R1R2AC6iv/NclJPOwpfhU=\");\n_c = MediaPipeErrorBoundary;\nclass ErrorBoundary extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      hasError: false\n    };\n  }\n  static getDerivedStateFromError(error) {\n    return {\n      hasError: true\n    };\n  }\n  componentDidCatch(error, errorInfo) {\n    if (this.props.onError) {\n      this.props.onError(error);\n    }\n  }\n  render() {\n    if (this.state.hasError) {\n      return null; // Let parent handle the error display\n    }\n    return this.props.children;\n  }\n}\nexport default function Measure() {\n  _s2();\n  var _meas$chestCm, _meas$shoulderCm, _meas$upperWaistCm;\n  const videoRef = useRef(null);\n  const canvasRef = useRef(null);\n  const poseRef = useRef(null);\n  const camRef = useRef(null);\n  const [phase, setPhase] = useState(\"calibrate\"); // 'calibrate' | 'measure' | 'locked'\n  const [status, setStatus] = useState(\"Hold an A4 sheet at chest level and match the bar width.\");\n  const [barPx, setBarPx] = useState(300);\n  const [cmPerPx, setCmPerPx] = useState(null);\n  const [calibrationQuality, setCalibrationQuality] = useState(0);\n  const [calibrationResults, setCalibrationResults] = useState([]);\n  const [currentCalibrationObject, setCurrentCalibrationObject] = useState(CALIBRATION_OBJECTS[0]);\n  const [calibrationStep, setCalibrationStep] = useState(0);\n  // 'Men' | 'Women' | 'Unisex'\n\n  const [locked, setLocked] = useState(false);\n  const [meas, setMeas] = useState(null); // { chestCm, shoulderCm, upperWaistCm, quality }\n\n  // stability settings\n  const GUIDE_MARGIN = 0.08;\n  const STABILITY_FRAMES = 12;\n  const MOVEMENT_EPS = 0.015;\n  const recentShoulderN = useRef([]);\n  const chestBuf = useRef([]);\n  const shoulderBuf = useRef([]);\n  const waistBuf = useRef([]);\n  const getDistance = useCallback((a, b) => Math.hypot(a.x - b.x, a.y - b.y), []);\n  const stopCamera = () => {\n    try {\n      var _camRef$current, _camRef$current$stop;\n      (_camRef$current = camRef.current) === null || _camRef$current === void 0 ? void 0 : (_camRef$current$stop = _camRef$current.stop) === null || _camRef$current$stop === void 0 ? void 0 : _camRef$current$stop.call(_camRef$current);\n      const v = videoRef.current;\n      (v === null || v === void 0 ? void 0 : v.srcObject) && v.srcObject.getTracks().forEach(t => t.stop());\n      if (v) v.srcObject = null;\n    } catch {}\n  };\n  const startCamera = async pose => {\n    const v = videoRef.current;\n    const camera = new Camera(v, {\n      onFrame: async () => {\n        await pose.send({\n          image: v\n        });\n      },\n      width: 1280,\n      height: 720\n    });\n    camRef.current = camera;\n    camera.start();\n  };\n  useEffect(() => {\n    const canvas = canvasRef.current;\n    const ctx = canvas.getContext(\"2d\");\n\n    // Simple MediaPipe initialization with error handling\n    try {\n      const pose = new Pose({\n        // Load from local public assets & force non‑SIMD to avoid WASM crash\n        locateFile: file => `/mediapipe/pose/${file.replace('simd_', '')}`\n      });\n      poseRef.current = pose;\n      pose.setOptions({\n        modelComplexity: 0,\n        // Use lowest complexity to avoid crashes\n        smoothLandmarks: true,\n        enableSegmentation: false,\n        minDetectionConfidence: 0.6,\n        // Higher confidence for stability\n        minTrackingConfidence: 0.6\n      });\n      pose.onResults(res => {\n        if (locked) return;\n        const W = res.image.width,\n          H = res.image.height;\n        if (canvas.width !== W) canvas.width = W;\n        if (canvas.height !== H) canvas.height = H;\n        ctx.save();\n        ctx.clearRect(0, 0, W, H);\n        ctx.drawImage(res.image, 0, 0, W, H);\n\n        // Enhanced guide box with gradient\n        const gx = W * GUIDE_MARGIN,\n          gy = H * GUIDE_MARGIN;\n        const gW = W * (1 - GUIDE_MARGIN * 2),\n          gH = H * (1 - GUIDE_MARGIN * 2);\n        const gradient = ctx.createLinearGradient(gx, gy, gx + gW, gy + gH);\n        gradient.addColorStop(0, \"rgba(59, 130, 246, 0.8)\"); // Blue\n        gradient.addColorStop(0.5, \"rgba(16, 185, 129, 0.8)\"); // Emerald\n        gradient.addColorStop(1, \"rgba(139, 92, 246, 0.8)\"); // Purple\n        ctx.strokeStyle = gradient;\n        ctx.lineWidth = 4;\n        ctx.strokeRect(gx, gy, gW, gH);\n\n        // calibration bar with better styling\n        if (phase === \"calibrate\") {\n          const barH = 20;\n          const barY = H * 0.12;\n\n          // Bar background with gradient\n          const barGradient = ctx.createLinearGradient((W - barPx) / 2, barY, (W - barPx) / 2 + barPx, barY);\n          barGradient.addColorStop(0, \"rgba(59, 130, 246, 0.9)\");\n          barGradient.addColorStop(1, \"rgba(16, 185, 129, 0.9)\");\n          ctx.fillStyle = barGradient;\n          ctx.fillRect((W - barPx) / 2, barY, barPx, barH);\n\n          // Bar border\n          ctx.strokeStyle = \"rgba(255, 255, 255, 0.9)\";\n          ctx.lineWidth = 2;\n          ctx.strokeRect((W - barPx) / 2, barY, barPx, barH);\n\n          // Instruction text with better styling\n          ctx.font = \"16px system-ui, -apple-system, sans-serif\";\n          ctx.fillStyle = \"rgba(255, 255, 255, 0.95)\";\n          ctx.strokeStyle = \"rgba(0, 0, 0, 0.5)\";\n          ctx.lineWidth = 3;\n          const text = \"Match this bar to A4 width (21 cm) at chest depth\";\n          const textX = Math.max(20, (W - ctx.measureText(text).width) / 2);\n          ctx.strokeText(text, textX, barY - 15);\n          ctx.fillText(text, textX, barY - 15);\n        }\n        const lm = res.poseLandmarks;\n        if (!lm) {\n          setStatus(\"Detecting body…\");\n          ctx.restore();\n          return;\n        }\n\n        // Enhanced overlay with better colors\n        drawBBox(ctx, lm, W, H, \"rgba(16, 185, 129, 0.9)\");\n        UPPER.forEach(([a, b]) => drawSeg(ctx, lm, a, b, \"#3B82F6\", 4, W, H)); // Blue\n        LOWER.forEach(([a, b]) => drawSeg(ctx, lm, a, b, \"#F59E0B\", 4, W, H)); // Amber\n\n        const vis = i => {\n          var _lm$i$visibility, _lm$i;\n          return ((_lm$i$visibility = (_lm$i = lm[i]) === null || _lm$i === void 0 ? void 0 : _lm$i.visibility) !== null && _lm$i$visibility !== void 0 ? _lm$i$visibility : 0) > 0.45;\n        };\n        const shouldersOK = vis(11) && vis(12);\n        const hipsOK = vis(23) || vis(24);\n        if (!(shouldersOK && hipsOK)) {\n          setStatus(\"Show shoulders & upper torso.\");\n          ctx.restore();\n          return;\n        }\n        const Lsh = lm[11],\n          Rsh = lm[12];\n        const Lhip = lm[23],\n          Rhip = lm[24];\n        const hip = vis(23) ? Lhip : Rhip;\n\n        // Enhanced key dots with glow effect\n        const shMid = {\n          x: (Lsh.x + Rsh.x) / 2,\n          y: (Lsh.y + Rsh.y) / 2\n        };\n        const keyPoints = [{\n          point: Lsh,\n          color: \"#3B82F6\"\n        }, {\n          point: Rsh,\n          color: \"#3B82F6\"\n        }, {\n          point: shMid,\n          color: \"#10B981\"\n        }, {\n          point: hip,\n          color: \"#F59E0B\"\n        }];\n        keyPoints.forEach(({\n          point,\n          color\n        }) => {\n          if (point) {\n            // Glow effect\n            ctx.shadowColor = color;\n            ctx.shadowBlur = 15;\n            ctx.fillStyle = color;\n            ctx.beginPath();\n            ctx.arc(point.x * W, point.y * H, 8, 0, Math.PI * 2);\n            ctx.fill();\n\n            // Inner bright dot\n            ctx.shadowBlur = 0;\n            ctx.fillStyle = \"white\";\n            ctx.beginPath();\n            ctx.arc(point.x * W, point.y * H, 4, 0, Math.PI * 2);\n            ctx.fill();\n          }\n        });\n        ctx.shadowBlur = 0;\n\n        // must be inside guide\n        const inside = [Lsh, Rsh, hip].every(p => p.x * W >= gx && p.x * W <= gx + gW && p.y * H >= gy && p.y * H <= gy + gH);\n        if (!inside) {\n          setStatus(\"Step back/center inside the frame.\");\n          ctx.restore();\n          return;\n        }\n        if (phase === \"calibrate\") {\n          setStatus(\"Adjust bar → Set calibration.\");\n          ctx.restore();\n          return;\n        }\n        if (!cmPerPx) {\n          setStatus(\"Click Set calibration first.\");\n          ctx.restore();\n          return;\n        }\n\n        // normalized stability\n        const shoulderWidthN = getDistance(Lsh, Rsh);\n        const torsoHeightN = getDistance(shMid, hip);\n        if (torsoHeightN <= 0) {\n          setStatus(\"Hold still…\");\n          ctx.restore();\n          return;\n        }\n        const bufN = recentShoulderN.current;\n        bufN.push(shoulderWidthN);\n        if (bufN.length > STABILITY_FRAMES) bufN.shift();\n        const avg = bufN.reduce((a, b) => a + b, 0) / bufN.length;\n        const maxDev = Math.max(...bufN.map(v => Math.abs(v - avg)));\n\n        // ----- measurements in cm -----\n        const shoulderPx = Math.abs((Lsh.x - Rsh.x) * W);\n        const shoulderCm = shoulderPx * cmPerPx;\n        const chestCmInstant = shoulderCm * CHEST_MULTIPLIER;\n        let upperWaistCmInstant = null;\n        if (vis(23) && vis(24)) {\n          const hipFlatCm = Math.abs((Lhip.x - Rhip.x) * W) * cmPerPx;\n          upperWaistCmInstant = hipFlatCm * UPPER_WAIST_FACTOR;\n        }\n\n        // median smoothing\n        const pushMed = (ref, val, n = 15) => {\n          if (val == null) return null;\n          ref.current.push(val);\n          if (ref.current.length > n) ref.current.shift();\n          const s = [...ref.current].sort((a, b) => a - b);\n          const m = Math.floor(s.length / 2);\n          return s.length % 2 ? s[m] : (s[m - 1] + s[m]) / 2;\n        };\n        const chestMed = pushMed(chestBuf, chestCmInstant);\n        const shoulderMed = pushMed(shoulderBuf, shoulderCm);\n        const waistMed = pushMed(waistBuf, upperWaistCmInstant);\n\n        // stability: normalized shoulders + cm spread\n        const spread = chestBuf.current.length >= 8 ? Math.max(...chestBuf.current) - Math.min(...chestBuf.current) : 999;\n        const stable = bufN.length >= STABILITY_FRAMES && maxDev < MOVEMENT_EPS && spread < 1.8; // slightly relaxed\n\n        if (stable && chestMed && shoulderMed) {\n          const out = {\n            chestCm: Number(chestMed.toFixed(1)),\n            shoulderCm: Number(shoulderMed.toFixed(1)),\n            upperWaistCm: waistMed ? Number(waistMed.toFixed(1)) : undefined,\n            quality: {\n              frames: chestBuf.current.length,\n              spreadCm: Number(spread.toFixed(2))\n            }\n          };\n          setMeas(out);\n          setLocked(true);\n          setPhase(\"locked\");\n          setStatus(\"Locked ✔️\");\n          stopCamera();\n        } else {\n          setStatus(\"Hold still…\");\n        }\n        ctx.restore();\n      });\n      startCamera(pose);\n      return () => {\n        stopCamera();\n      };\n    } catch (error) {\n      console.error(\"❌ MediaPipe initialization failed:\", error);\n      setStatus(`MediaPipe Error: ${error.message}. Please refresh the page.`);\n      setPhase(\"error\");\n    }\n  }, [phase, cmPerPx, getDistance, locked, barPx]);\n  const setCalibration = () => {\n    if (barPx < 40) return;\n    setCmPerPx(A4_WIDTH_CM / barPx);\n    setPhase(\"measure\");\n    setStatus(\"Calibration set. Stand centered; shoulders & upper torso visible.\");\n    // reset buffers\n    chestBuf.current = [];\n    shoulderBuf.current = [];\n    waistBuf.current = [];\n    recentShoulderN.current = [];\n  };\n  const retake = () => {\n    setLocked(false);\n    setMeas(null);\n    setPhase(\"measure\");\n    setStatus(\"Stand centered; hold still 1–2 seconds.\");\n    chestBuf.current = [];\n    shoulderBuf.current = [];\n    waistBuf.current = [];\n    recentShoulderN.current = [];\n    if (poseRef.current) startCamera(poseRef.current);\n  };\n  const recalibrate = () => {\n    setLocked(false);\n    setMeas(null);\n    setPhase(\"calibrate\");\n    setStatus(\"Hold an A4 sheet at chest level and match the bar width.\");\n    chestBuf.current = [];\n    shoulderBuf.current = [];\n    waistBuf.current = [];\n    recentShoulderN.current = [];\n    if (poseRef.current) startCamera(poseRef.current);\n  };\n\n  // Helper functions for UI\n  const getStatusIcon = () => {\n    if (phase === \"locked\") return /*#__PURE__*/_jsxDEV(\"span\", {\n      className: \"text-emerald-500 text-xl\",\n      children: \"\\u2705\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 620,\n      columnNumber: 36\n    }, this);\n    if (phase === \"measure\") return /*#__PURE__*/_jsxDEV(Activity, {\n      className: \"w-5 h-5 text-blue-500 animate-pulse\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 621,\n      columnNumber: 37\n    }, this);\n    return /*#__PURE__*/_jsxDEV(Target, {\n      className: \"w-5 h-5 text-amber-500\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 622,\n      columnNumber: 12\n    }, this);\n  };\n  const getPhaseColor = () => {\n    if (phase === \"locked\") return \"from-emerald-500 to-green-500\";\n    if (phase === \"measure\") return \"from-blue-500 to-cyan-500\";\n    return \"from-amber-500 to-orange-500\";\n  };\n  return /*#__PURE__*/_jsxDEV(MediaPipeErrorBoundary, {\n    children: /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"min-h-screen bg-gradient-to-br from-gray-900 via-blue-900 to-indigo-900 relative overflow-hidden\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"absolute inset-0\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"absolute top-10 left-10 w-72 h-72 bg-blue-500/10 rounded-full blur-3xl animate-pulse\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 636,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"absolute bottom-10 right-10 w-96 h-96 bg-emerald-500/10 rounded-full blur-3xl animate-pulse delay-1000\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 637,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 w-80 h-80 bg-purple-500/5 rounded-full blur-3xl animate-pulse delay-2000\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 638,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 635,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"relative z-10 flex flex-col items-center min-h-screen\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"w-full max-w-7xl flex items-center justify-between px-6 py-6\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"flex items-center space-x-4\",\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"w-12 h-12 bg-gradient-to-r from-blue-500 to-emerald-500 rounded-2xl flex items-center justify-center shadow-lg\",\n              children: /*#__PURE__*/_jsxDEV(Sparkles, {\n                className: \"w-7 h-7 text-white\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 646,\n                columnNumber: 17\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 645,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              children: [/*#__PURE__*/_jsxDEV(\"h1\", {\n                className: \"text-2xl font-bold text-white\",\n                children: \"AI Fashion Fit\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 649,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n                className: \"text-sm text-blue-200\",\n                children: \"Body Measurement System\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 650,\n                columnNumber: 17\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 648,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 644,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"flex items-center space-x-3\",\n            children: /*#__PURE__*/_jsxDEV(\"div\", {\n              className: `bg-gradient-to-r ${getPhaseColor()} rounded-full px-6 py-3 shadow-lg backdrop-blur-sm border border-white/10`,\n              children: /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"flex items-center space-x-3 text-white\",\n                children: [getStatusIcon(), /*#__PURE__*/_jsxDEV(\"span\", {\n                  className: \"font-medium text-sm\",\n                  children: status\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 659,\n                  columnNumber: 19\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 657,\n                columnNumber: 17\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 656,\n              columnNumber: 15\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 655,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 643,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"w-full max-w-6xl px-6 flex-1 flex items-center\",\n          children: /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"relative w-full bg-black/20 backdrop-blur-lg rounded-3xl overflow-hidden shadow-2xl border border-white/10\",\n            children: /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"relative aspect-video\",\n              children: [/*#__PURE__*/_jsxDEV(\"video\", {\n                ref: videoRef,\n                className: \"absolute inset-0 w-full h-full object-contain bg-black rounded-3xl\",\n                autoPlay: true,\n                muted: true,\n                playsInline: true\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 669,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"canvas\", {\n                ref: canvasRef,\n                className: \"absolute inset-0 w-full h-full object-contain pointer-events-none\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 670,\n                columnNumber: 17\n              }, this), phase === \"calibrate\" && /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"absolute bottom-6 left-1/2 transform -translate-x-1/2\",\n                children: /*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"bg-white/95 backdrop-blur-md rounded-2xl px-8 py-6 shadow-2xl border border-white/20 max-w-4xl\",\n                  children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                    className: \"text-center mb-4\",\n                    children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n                      className: \"text-lg font-bold text-gray-800 mb-2\",\n                      children: \"Advanced Calibration System\"\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 677,\n                      columnNumber: 25\n                    }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n                      className: \"text-sm text-gray-600\",\n                      children: \"Use multiple objects for higher accuracy\"\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 678,\n                      columnNumber: 25\n                    }, this)]\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 676,\n                    columnNumber: 23\n                  }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                    className: \"flex justify-center space-x-4 mb-4\",\n                    children: CALIBRATION_OBJECTS.map((obj, index) => /*#__PURE__*/_jsxDEV(\"button\", {\n                      onClick: () => setCurrentCalibrationObject(obj),\n                      className: `px-4 py-2 rounded-lg text-sm font-medium transition-all ${currentCalibrationObject.name === obj.name ? 'bg-blue-500 text-white shadow-lg' : 'bg-gray-100 text-gray-700 hover:bg-gray-200'}`,\n                      children: obj.name\n                    }, obj.name, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 684,\n                      columnNumber: 27\n                    }, this))\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 682,\n                    columnNumber: 23\n                  }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                    className: \"text-center mb-4\",\n                    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                      className: \"text-sm text-gray-600 mb-2\",\n                      children: currentCalibrationObject.description\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 700,\n                      columnNumber: 25\n                    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                      className: \"text-lg font-bold text-blue-600\",\n                      children: [\"Expected Width: \", currentCalibrationObject.width, \"cm\"]\n                    }, void 0, true, {\n                      fileName: _jsxFileName,\n                      lineNumber: 703,\n                      columnNumber: 25\n                    }, this)]\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 699,\n                    columnNumber: 23\n                  }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                    className: \"flex items-center justify-center space-x-4\",\n                    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                      className: \"flex items-center space-x-2\",\n                      children: [/*#__PURE__*/_jsxDEV(Target, {\n                        className: \"w-5 h-5 text-amber-600\"\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 711,\n                        columnNumber: 27\n                      }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                        className: \"text-sm font-medium text-gray-700\",\n                        children: [\"Adjust bar to match \", currentCalibrationObject.name, \" width\"]\n                      }, void 0, true, {\n                        fileName: _jsxFileName,\n                        lineNumber: 712,\n                        columnNumber: 27\n                      }, this)]\n                    }, void 0, true, {\n                      fileName: _jsxFileName,\n                      lineNumber: 710,\n                      columnNumber: 25\n                    }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n                      type: \"range\",\n                      min: 120,\n                      max: 900,\n                      value: barPx,\n                      onChange: e => setBarPx(Number(e.target.value)),\n                      className: \"w-64 accent-blue-500\"\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 716,\n                      columnNumber: 25\n                    }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n                      onClick: () => performCalibration(currentCalibrationObject),\n                      className: \"bg-gradient-to-r from-blue-500 to-emerald-500 hover:from-blue-600 hover:to-emerald-600 text-white px-4 py-2 rounded-xl font-medium transition-all duration-300 transform hover:scale-105 shadow-lg flex items-center space-x-2\",\n                      children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                        className: \"text-white text-lg\",\n                        children: \"\\uD83D\\uDCCF\"\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 728,\n                        columnNumber: 27\n                      }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                        children: \"Calibrate\"\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 729,\n                        columnNumber: 27\n                      }, this)]\n                    }, void 0, true, {\n                      fileName: _jsxFileName,\n                      lineNumber: 724,\n                      columnNumber: 25\n                    }, this)]\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 709,\n                    columnNumber: 23\n                  }, this), calibrationResults.length > 0 && /*#__PURE__*/_jsxDEV(\"div\", {\n                    className: \"mt-4 p-3 bg-gray-50 rounded-lg\",\n                    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                      className: \"text-sm font-medium text-gray-700 mb-2\",\n                      children: \"Calibration Results:\"\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 736,\n                      columnNumber: 27\n                    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                      className: \"space-y-1\",\n                      children: calibrationResults.map((result, index) => /*#__PURE__*/_jsxDEV(\"div\", {\n                        className: \"text-xs text-gray-600\",\n                        children: [result.object, \": \", result.measuredCm.toFixed(2), \"cm (Expected: \", result.expectedCm, \"cm) - Accuracy: \", (result.accuracy * 100).toFixed(1), \"%\"]\n                      }, index, true, {\n                        fileName: _jsxFileName,\n                        lineNumber: 739,\n                        columnNumber: 31\n                      }, this))\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 737,\n                      columnNumber: 27\n                    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                      className: \"mt-2 text-sm font-bold text-gray-800\",\n                      children: [\"Overall Quality: \", (calibrationQuality * 100).toFixed(1), \"%\"]\n                    }, void 0, true, {\n                      fileName: _jsxFileName,\n                      lineNumber: 745,\n                      columnNumber: 27\n                    }, this)]\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 735,\n                    columnNumber: 25\n                  }, this), calibrationQuality >= CALIBRATION_THRESHOLD && /*#__PURE__*/_jsxDEV(\"div\", {\n                    className: \"mt-4 text-center\",\n                    children: /*#__PURE__*/_jsxDEV(\"button\", {\n                      onClick: () => {\n                        setPhase(\"measure\");\n                        setStatus(\"Calibration complete! Position yourself in the frame.\");\n                      },\n                      className: \"bg-gradient-to-r from-emerald-500 to-green-500 hover:from-emerald-600 hover:to-green-600 text-white px-6 py-3 rounded-xl font-medium transition-all duration-300 transform hover:scale-105 shadow-lg\",\n                      children: \"\\uD83C\\uDFAF Proceed to Measurement\"\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 754,\n                      columnNumber: 27\n                    }, this)\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 753,\n                    columnNumber: 25\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 675,\n                  columnNumber: 21\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 674,\n                columnNumber: 19\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 668,\n              columnNumber: 15\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 667,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 666,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"w-full max-w-4xl px-6 py-4\",\n          children: /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"bg-white/10 backdrop-blur-md rounded-2xl p-6 border border-white/20\",\n            children: /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"text-center text-white\",\n              children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"flex items-center justify-center space-x-2 mb-3\",\n                children: [/*#__PURE__*/_jsxDEV(CameraIcon, {\n                  className: \"w-5 h-5 text-blue-300\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 783,\n                  columnNumber: 19\n                }, this), /*#__PURE__*/_jsxDEV(\"h3\", {\n                  className: \"font-semibold\",\n                  children: \"Instructions\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 784,\n                  columnNumber: 19\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 782,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"text-sm text-white/80 space-y-2\",\n                children: [phase === \"calibrate\" && /*#__PURE__*/_jsxDEV(\"p\", {\n                  children: \"\\uD83D\\uDCC4 Hold an A4 sheet at chest level and adjust the bar to match its width for accurate calibration.\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 788,\n                  columnNumber: 21\n                }, this), phase === \"measure\" && /*#__PURE__*/_jsxDEV(\"p\", {\n                  children: \"\\uD83E\\uDDCD Stand straight with arms slightly away from your body. Hold still for precise measurement.\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 791,\n                  columnNumber: 21\n                }, this), phase === \"locked\" && /*#__PURE__*/_jsxDEV(\"p\", {\n                  children: \"\\u2705 Measurements captured successfully! You can retake if needed or save your results.\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 794,\n                  columnNumber: 21\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 786,\n                columnNumber: 17\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 781,\n              columnNumber: 15\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 780,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 779,\n          columnNumber: 11\n        }, this), phase === \"locked\" && meas && /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"w-full max-w-4xl px-6 py-6\",\n          children: /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"bg-white/95 backdrop-blur-md rounded-2xl p-6 border border-gray-200 shadow-xl\",\n            children: /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"text-center text-gray-800\",\n              children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n                className: \"text-xl font-bold mb-4\",\n                children: \"\\uD83D\\uDCCA Measurement Results\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 806,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"grid grid-cols-1 md:grid-cols-3 gap-4 mb-6\",\n                children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"bg-blue-50 rounded-xl p-4 border border-blue-200\",\n                  children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                    className: \"text-2xl font-bold text-blue-600\",\n                    children: ((_meas$chestCm = meas.chestCm) === null || _meas$chestCm === void 0 ? void 0 : _meas$chestCm.toFixed(1)) || 'N/A'\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 811,\n                    columnNumber: 23\n                  }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                    className: \"text-sm text-blue-500\",\n                    children: \"Chest (cm)\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 812,\n                    columnNumber: 23\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 810,\n                  columnNumber: 21\n                }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"bg-emerald-50 rounded-xl p-4 border border-emerald-200\",\n                  children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                    className: \"text-2xl font-bold text-emerald-600\",\n                    children: ((_meas$shoulderCm = meas.shoulderCm) === null || _meas$shoulderCm === void 0 ? void 0 : _meas$shoulderCm.toFixed(1)) || 'N/A'\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 815,\n                    columnNumber: 23\n                  }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                    className: \"text-sm text-emerald-500\",\n                    children: \"Shoulder (cm)\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 816,\n                    columnNumber: 23\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 814,\n                  columnNumber: 21\n                }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"bg-purple-50 rounded-xl p-4 border border-purple-200\",\n                  children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                    className: \"text-2xl font-bold text-purple-600\",\n                    children: ((_meas$upperWaistCm = meas.upperWaistCm) === null || _meas$upperWaistCm === void 0 ? void 0 : _meas$upperWaistCm.toFixed(1)) || 'N/A'\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 819,\n                    columnNumber: 23\n                  }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                    className: \"text-sm text-purple-500\",\n                    children: \"Waist (cm)\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 820,\n                    columnNumber: 23\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 818,\n                  columnNumber: 21\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 809,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"bg-gradient-to-r from-blue-50 to-emerald-50 rounded-xl p-4 mb-6 border border-blue-200\",\n                children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"text-lg font-semibold text-gray-700 mb-2\",\n                  children: \"Recommended Size\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 826,\n                  columnNumber: 21\n                }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"text-3xl font-bold bg-gradient-to-r from-blue-600 to-emerald-600 bg-clip-text text-transparent\",\n                  children: recommendTopSize(meas.chestCm, meas.upperWaistCm, meas.shoulderCm)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 827,\n                  columnNumber: 39\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 825,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"flex flex-col sm:flex-row gap-3 justify-center\",\n                children: [/*#__PURE__*/_jsxDEV(\"button\", {\n                  onClick: retake,\n                  className: \"bg-gray-200 hover:bg-gray-300 text-gray-700 px-6 py-3 rounded-xl font-medium transition-all duration-300 border-2 border-gray-300\",\n                  children: \"\\uD83D\\uDD04 Retake\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 834,\n                  columnNumber: 21\n                }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n                  onClick: recalibrate,\n                  className: \"bg-blue-100 hover:bg-blue-200 text-blue-700 px-6 py-3 rounded-xl font-medium transition-all duration-300 border-2 border-blue-300\",\n                  children: \"\\uD83C\\uDFAF Recalibrate\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 840,\n                  columnNumber: 21\n                }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n                  onClick: () => {\n                    const recommendedSize = recommendTopSize(meas.chestCm, meas.upperWaistCm, meas.shoulderCm);\n                    if (recommendedSize) {\n                      // Pass all measurement data to recommendations page\n                      const measurementData = encodeURIComponent(JSON.stringify({\n                        size: recommendedSize,\n                        gender: 'Men',\n                        measurements: {\n                          chestCm: meas.chestCm,\n                          shoulderCm: meas.shoulderCm,\n                          upperWaistCm: meas.upperWaistCm\n                        }\n                      }));\n                      window.location.href = `/recommendations?data=${measurementData}`;\n                    }\n                  },\n                  className: \"bg-gradient-to-r from-purple-500 to-pink-500 hover:from-purple-600 hover:to-pink-600 text-white px-6 py-3 rounded-xl font-medium transition-all duration-300 shadow-lg\",\n                  children: \"\\u2728 Get Recommendations\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 846,\n                  columnNumber: 21\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 833,\n                columnNumber: 19\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 805,\n              columnNumber: 17\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 804,\n            columnNumber: 15\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 803,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 641,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 633,\n      columnNumber: 7\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 632,\n    columnNumber: 5\n  }, this);\n}\n_s2(Measure, \"Cvfc3PFy1lPclQ5VQHEn5WR6o4Q=\");\n_c2 = Measure;\nvar _c, _c2;\n$RefreshReg$(_c, \"MediaPipeErrorBoundary\");\n$RefreshReg$(_c2, \"Measure\");","map":{"version":3,"names":["React","useRef","useEffect","useState","useCallback","Pose","Camera","CameraIcon","Sparkles","Activity","Target","RotateCcw","Download","jsxDEV","_jsxDEV","A4_WIDTH_CM","CHEST_MULTIPLIER","UPPER_WAIST_FACTOR","UPPER","LOWER","drawSeg","ctx","lm","a","b","color","width","W","H","_A$visibility","_B$visibility","A","B","visibility","strokeStyle","lineWidth","beginPath","moveTo","x","y","lineTo","stroke","drawBBox","pts","filter","p","_p$visibility","length","xs","map","ys","minX","Math","max","min","maxX","minY","maxY","pad","strokeRect","recommendTopSize","chestCm","waistCm","shoulderCm","SIZE_DISTRIBUTION","percentile","description","primarySize","size","data","Object","entries","bodyType","classifyBodyType","sizeAdjustment","waistChestRatio","shoulderChestRatio","sizeOrder","currentIndex","indexOf","adjustedIndex","round","finalSize","confidence","calculateSizeConfidence","console","log","measurements","proportions","toFixed","adjustments","populationData","recommendedSize","sizeRanges","range","midPoint","distanceFromMid","abs","rangeWidth","positionConfidence","styleHint","ratio","CALIBRATION_OBJECTS","name","height","CALIBRATION_THRESHOLD","validateCalibration","measuredPx","expectedCm","cmPerPx","measuredCm","error","accuracy","calculateCalibrationQuality","calibrationResults","totalAccuracy","reduce","sum","result","averageAccuracy","bonus","MEASUREMENT_QUALITY_THRESHOLD","validateHumanProportions","issues","qualityScore","chestShoulderRatio","push","isValid","calculateMeasurementQuality","stabilityData","upperWaistCm","quality","proportionValidation","stabilityScore","spreadCm","frameScore","frames","overallQuality","proportionQuality","stabilityQuality","frameQuality","MediaPipeErrorBoundary","children","_s","hasError","setHasError","errorMessage","setErrorMessage","className","fileName","_jsxFileName","lineNumber","columnNumber","onClick","window","location","reload","ErrorBoundary","onError","message","_c","Component","constructor","props","state","getDerivedStateFromError","componentDidCatch","errorInfo","render","Measure","_s2","_meas$chestCm","_meas$shoulderCm","_meas$upperWaistCm","videoRef","canvasRef","poseRef","camRef","phase","setPhase","status","setStatus","barPx","setBarPx","setCmPerPx","calibrationQuality","setCalibrationQuality","setCalibrationResults","currentCalibrationObject","setCurrentCalibrationObject","calibrationStep","setCalibrationStep","locked","setLocked","meas","setMeas","GUIDE_MARGIN","STABILITY_FRAMES","MOVEMENT_EPS","recentShoulderN","chestBuf","shoulderBuf","waistBuf","getDistance","hypot","stopCamera","_camRef$current","_camRef$current$stop","current","stop","call","v","srcObject","getTracks","forEach","t","startCamera","pose","camera","onFrame","send","image","start","canvas","getContext","locateFile","file","replace","setOptions","modelComplexity","smoothLandmarks","enableSegmentation","minDetectionConfidence","minTrackingConfidence","onResults","res","save","clearRect","drawImage","gx","gy","gW","gH","gradient","createLinearGradient","addColorStop","barH","barY","barGradient","fillStyle","fillRect","font","text","textX","measureText","strokeText","fillText","poseLandmarks","restore","vis","i","_lm$i$visibility","_lm$i","shouldersOK","hipsOK","Lsh","Rsh","Lhip","Rhip","hip","shMid","keyPoints","point","shadowColor","shadowBlur","arc","PI","fill","inside","every","shoulderWidthN","torsoHeightN","bufN","shift","avg","maxDev","shoulderPx","chestCmInstant","upperWaistCmInstant","hipFlatCm","pushMed","ref","val","n","s","sort","m","floor","chestMed","shoulderMed","waistMed","spread","stable","out","Number","undefined","setCalibration","retake","recalibrate","getStatusIcon","getPhaseColor","autoPlay","muted","playsInline","obj","index","type","value","onChange","e","target","performCalibration","object","measurementData","encodeURIComponent","JSON","stringify","gender","href","_c2","$RefreshReg$"],"sources":["/Users/dhirajbalayar/Desktop/fashion/frontend/src/pages/Measure.jsx"],"sourcesContent":["// src/pages/Measure.jsx\nimport React, { useRef, useEffect, useState, useCallback } from \"react\";\nimport { Pose } from \"@mediapipe/pose\";\nimport { Camera } from \"@mediapipe/camera_utils\";\nimport { Camera as CameraIcon, Sparkles, Activity, Target, RotateCcw, Download } from 'lucide-react';\n\n/* ---------- Calibration ---------- */\nconst A4_WIDTH_CM = 21.0; // reference width\nconst CHEST_MULTIPLIER = 1.75; // shoulder flat → chest circumference (tune 1.70–1.85)\nconst UPPER_WAIST_FACTOR = 0.90; // hip width ≈ a bit wider than upper waist\n\n/* ---------- Overlay helpers ---------- */\nconst UPPER = [\n  [0,1],[1,2],[2,3],[3,7],\n  [0,11],[0,12],\n  [11,13],[13,15],\n  [12,14],[14,16],\n  [11,12],\n  [11,23],[12,24],\n];\nconst LOWER = [\n  [23,25],[25,27],[27,31],\n  [24,26],[26,28],[28,32],\n  [23,24],\n];\nconst drawSeg = (ctx, lm, a, b, color, width, W, H) => {\n  const A = lm[a], B = lm[b];\n  if (!A || !B) return;\n  if ((A.visibility ?? 0) < 0.4 || (B.visibility ?? 0) < 0.4) return;\n  ctx.strokeStyle = color; ctx.lineWidth = width;\n  ctx.beginPath(); ctx.moveTo(A.x*W, A.y*H); ctx.lineTo(B.x*W, B.y*H); ctx.stroke();\n};\nconst drawBBox = (ctx, lm, W, H, color=\"rgba(0,255,0,0.9)\") => {\n  const pts = lm.filter(p => (p?.visibility ?? 0) > 0.4);\n  if (!pts.length) return;\n  const xs = pts.map(p=>p.x*W), ys = pts.map(p=>p.y*H);\n  const minX = Math.max(0, Math.min(...xs)), maxX = Math.min(W, Math.max(...xs));\n  const minY = Math.max(0, Math.min(...ys)), maxY = Math.min(H, Math.max(...ys));\n  const pad = 8; ctx.strokeStyle = color; ctx.lineWidth = 3;\n  ctx.strokeRect(minX-pad, minY-pad, (maxX-minX)+pad*2, (maxY-minY)+pad*2);\n};\n\n/* ---------- Size recommendation (using all three measurements) ---------- */\nconst recommendTopSize = (chestCm, waistCm, shoulderCm) => {\n  if (!chestCm || !waistCm || !shoulderCm || chestCm <= 0 || waistCm <= 0 || shoulderCm <= 0) {\n    return null;\n  }\n  \n  // Population-based sizing algorithm using statistical human measurement data\n  // Based on research from clothing industry standards and anthropometric studies\n  \n  // Statistical size distribution (percentiles from human measurement studies)\n  const SIZE_DISTRIBUTION = {\n    'XXS': { min: 70, max: 79, percentile: 5, description: 'Very small frame (5% of population)' },\n    'XS': { min: 80, max: 84, percentile: 15, description: 'Small frame (10% of population)' },\n    'S': { min: 85, max: 89, percentile: 30, description: 'Small-medium frame (15% of population)' },\n    'M': { min: 90, max: 94, percentile: 50, description: 'Medium frame (20% of population - most common)' },\n    'L': { min: 95, max: 99, percentile: 70, description: 'Large frame (20% of population)' },\n    'XL': { min: 100, max: 104, percentile: 85, description: 'Extra large frame (15% of population)' },\n    'XXL': { min: 105, max: 109, percentile: 95, description: '2X large frame (10% of population)' },\n    '3XL': { min: 110, max: 114, percentile: 98, description: '3X large frame (3% of population)' },\n    '4XL': { min: 115, max: 120, percentile: 100, description: '4X large frame (2% of population)' }\n  };\n  \n  // Primary size based on chest measurement (most reliable indicator)\n  let primarySize = 'M';\n  for (const [size, data] of Object.entries(SIZE_DISTRIBUTION)) {\n    if (chestCm >= data.min && chestCm <= data.max) {\n      primarySize = size;\n      break;\n    }\n  }\n  \n  // Body type classification based on proportions\n  const bodyType = classifyBodyType(chestCm, waistCm, shoulderCm);\n  \n  // Size adjustment based on body type and proportions\n  let sizeAdjustment = 0;\n  \n  // Waist-to-chest ratio adjustment (body shape)\n  const waistChestRatio = waistCm / chestCm;\n  if (waistChestRatio < 0.75) {\n    // Ectomorph (slim) - consider going down one size\n    sizeAdjustment -= 0.5;\n  } else if (waistChestRatio > 0.90) {\n    // Endomorph (full) - consider going up one size\n    sizeAdjustment += 0.5;\n  }\n  \n  // Shoulder-to-chest ratio adjustment (upper body build)\n  const shoulderChestRatio = shoulderCm / chestCm;\n  if (shoulderChestRatio > 0.58) {\n    // Broad shoulders (athletic) - consider going up one size\n    sizeAdjustment += 0.5;\n  } else if (shoulderChestRatio < 0.48) {\n    // Narrow shoulders - consider going down one size\n    sizeAdjustment -= 0.5;\n  }\n  \n  // Apply size adjustments with bounds checking\n  const sizeOrder = ['XXS', 'XS', 'S', 'M', 'L', 'XL', 'XXL', '3XL', '4XL'];\n  const currentIndex = sizeOrder.indexOf(primarySize);\n  const adjustedIndex = Math.max(0, Math.min(sizeOrder.length - 1, currentIndex + Math.round(sizeAdjustment)));\n  \n  const finalSize = sizeOrder[adjustedIndex];\n  \n  // Calculate confidence score for this recommendation\n  const confidence = calculateSizeConfidence(chestCm, waistCm, shoulderCm, finalSize);\n  \n  // Log detailed calculation for debugging and research\n  console.log(`Enhanced Size Calculation:`, {\n    measurements: { chestCm, waistCm, shoulderCm },\n    primarySize,\n    bodyType,\n    proportions: {\n      waistChestRatio: waistChestRatio.toFixed(3),\n      shoulderChestRatio: shoulderChestRatio.toFixed(3)\n    },\n    adjustments: { sizeAdjustment, finalSize },\n    confidence,\n    populationData: SIZE_DISTRIBUTION[finalSize]\n  });\n  \n  return finalSize;\n};\n\n// Body type classification based on anthropometric research\nconst classifyBodyType = (chestCm, waistCm, shoulderCm) => {\n  const waistChestRatio = waistCm / chestCm;\n  const shoulderChestRatio = shoulderCm / chestCm;\n  \n  if (waistChestRatio < 0.75 && shoulderChestRatio < 0.52) {\n    return 'Ectomorph (Slim)';\n  } else if (waistChestRatio > 0.90 && shoulderChestRatio > 0.58) {\n    return 'Endomorph (Full)';\n  } else if (shoulderChestRatio > 0.55 && waistChestRatio < 0.85) {\n    return 'Mesomorph (Athletic)';\n  } else {\n    return 'Balanced';\n  }\n};\n\n// Calculate confidence in size recommendation\nconst calculateSizeConfidence = (chestCm, waistCm, shoulderCm, recommendedSize) => {\n  let confidence = 0.8; // Base confidence\n  \n  // Higher confidence for measurements in middle of size ranges\n  const sizeRanges = {\n    'XXS': [70, 79], 'XS': [80, 84], 'S': [85, 89], 'M': [90, 94],\n    'L': [95, 99], 'XL': [100, 104], 'XXL': [105, 109], '3XL': [110, 114], '4XL': [115, 120]\n  };\n  \n  const range = sizeRanges[recommendedSize];\n  if (range) {\n    const midPoint = (range[0] + range[1]) / 2;\n    const distanceFromMid = Math.abs(chestCm - midPoint);\n    const rangeWidth = range[1] - range[0];\n    const positionConfidence = 1 - (distanceFromMid / (rangeWidth / 2));\n    confidence += positionConfidence * 0.2;\n  }\n  \n  return Math.min(1, Math.max(0, confidence));\n};\n\n// Optional style hint based on proportions (very light heuristic)\nconst styleHint = (chestCm, shoulderCm) => {\n  if (!chestCm || !shoulderCm) return \"\";\n  const ratio = chestCm / (shoulderCm || 1); // ~3–5 normal range\n  if (ratio < 3.6) return \"Try regular/relaxed fits.\";\n  if (ratio > 4.6) return \"Slim or tailored fits may suit better.\";\n  return \"Regular fit is likely comfortable.\";\n};\n\n/* ---------- Enhanced Calibration System ---------- */\nconst CALIBRATION_OBJECTS = [\n  { name: 'A4 Paper', width: 21.0, height: 29.7, description: 'Standard A4 paper (21.0 × 29.7 cm)' },\n  { name: 'Credit Card', width: 8.56, height: 5.4, description: 'Standard credit card (8.56 × 5.4 cm)' },\n  { name: 'iPhone', width: 7.15, height: 14.7, description: 'iPhone 14 Pro (7.15 × 14.7 cm)' }\n];\n\nconst CALIBRATION_THRESHOLD = 0.8; // Minimum calibration quality to proceed\n\n// Enhanced calibration validation\nconst validateCalibration = (measuredPx, expectedCm, cmPerPx) => {\n  const measuredCm = measuredPx * cmPerPx;\n  const error = Math.abs(measuredCm - expectedCm);\n  const accuracy = Math.max(0, 1 - (error / expectedCm));\n  return { accuracy, error, measuredCm, expectedCm };\n};\n\n// Calculate overall calibration quality\nconst calculateCalibrationQuality = (calibrationResults) => {\n  if (calibrationResults.length === 0) return 0;\n  \n  const totalAccuracy = calibrationResults.reduce((sum, result) => sum + result.accuracy, 0);\n  const averageAccuracy = totalAccuracy / calibrationResults.length;\n  \n  // Bonus for multiple successful calibrations\n  const bonus = calibrationResults.length >= 2 ? 0.1 : 0;\n  \n  return Math.min(1, averageAccuracy + bonus);\n};\n\n/* ---------- Enhanced Measurement Validation System ---------- */\nconst MEASUREMENT_QUALITY_THRESHOLD = 0.7; // Minimum quality to accept measurements\n\n// Validate realistic human proportions\nconst validateHumanProportions = (chestCm, waistCm, shoulderCm) => {\n  const issues = [];\n  let qualityScore = 1.0;\n  \n  // Chest to shoulder ratio (should be 2.5-4.5 for humans)\n  const chestShoulderRatio = chestCm / shoulderCm;\n  if (chestShoulderRatio < 2.5) {\n    issues.push(`Chest/shoulder ratio too low: ${chestShoulderRatio.toFixed(2)} (expected 2.5-4.5)`);\n    qualityScore -= 0.3;\n  } else if (chestShoulderRatio > 4.5) {\n    issues.push(`Chest/shoulder ratio too high: ${chestShoulderRatio.toFixed(2)} (expected 2.5-4.5)`);\n    qualityScore -= 0.3;\n  }\n  \n  // Waist to chest ratio (should be 0.7-0.95 for humans)\n  const waistChestRatio = waistCm / chestCm;\n  if (waistChestRatio < 0.7) {\n    issues.push(`Waist/chest ratio too low: ${waistChestRatio.toFixed(2)} (expected 0.7-0.95)`);\n    qualityScore -= 0.2;\n  } else if (waistChestRatio > 0.95) {\n    issues.push(`Waist/chest ratio too high: ${waistChestRatio.toFixed(2)} (expected 0.7-0.95)`);\n    qualityScore -= 0.2;\n  }\n  \n  // Absolute measurement ranges (realistic human limits)\n  if (chestCm < 60 || chestCm > 140) {\n    issues.push(`Chest measurement unrealistic: ${chestCm}cm (expected 60-140cm)`);\n    qualityScore -= 0.4;\n  }\n  \n  if (shoulderCm < 30 || shoulderCm > 70) {\n    issues.push(`Shoulder measurement unrealistic: ${shoulderCm}cm (expected 30-70cm)`);\n    qualityScore -= 0.4;\n  }\n  \n  if (waistCm < 50 || waistCm > 120) {\n    issues.push(`Waist measurement unrealistic: ${waistCm}cm (expected 50-120cm)`);\n    qualityScore -= 0.3;\n  }\n  \n  return {\n    qualityScore: Math.max(0, qualityScore),\n    issues,\n    isValid: qualityScore >= MEASUREMENT_QUALITY_THRESHOLD\n  };\n};\n\n// Enhanced measurement quality scoring\nconst calculateMeasurementQuality = (measurements, stabilityData) => {\n  const { chestCm, shoulderCm, upperWaistCm, quality } = measurements;\n  \n  // Proportion validation\n  const proportionValidation = validateHumanProportions(chestCm, upperWaistCm, shoulderCm);\n  \n  // Stability scoring\n  const stabilityScore = Math.max(0, 1 - (quality.spreadCm / 3)); // 3cm max spread\n  \n  // Frame count scoring\n  const frameScore = Math.min(1, quality.frames / 15); // 15 frames = perfect\n  \n  // Overall quality calculation\n  const overallQuality = (\n    proportionValidation.qualityScore * 0.5 +\n    stabilityScore * 0.3 +\n    frameScore * 0.2\n  );\n  \n  return {\n    overallQuality: Math.round(overallQuality * 100) / 100,\n    proportionQuality: Math.round(proportionValidation.qualityScore * 100) / 100,\n    stabilityQuality: Math.round(stabilityScore * 100) / 100,\n    frameQuality: Math.round(frameScore * 100) / 100,\n    issues: proportionValidation.issues,\n    isValid: proportionValidation.isValid && overallQuality >= MEASUREMENT_QUALITY_THRESHOLD\n  };\n};\n\n// Add error handling wrapper at the top of the component\nconst MediaPipeErrorBoundary = ({ children }) => {\n  const [hasError, setHasError] = useState(false);\n  const [errorMessage, setErrorMessage] = useState('');\n\n  if (hasError) {\n    return (\n      <div className=\"min-h-screen bg-gradient-to-br from-gray-900 via-blue-900 to-indigo-900 flex items-center justify-center\">\n        <div className=\"bg-white/95 backdrop-blur-md rounded-3xl p-8 max-w-lg text-center\">\n          <div className=\"w-16 h-16 bg-red-100 rounded-full flex items-center justify-center mx-auto mb-4\">\n            <span className=\"text-2xl\">⚠️</span>\n          </div>\n          <h2 className=\"text-2xl font-bold text-gray-800 mb-4\">MediaPipe Error</h2>\n          <p className=\"text-gray-600 mb-6\">{errorMessage}</p>\n          <div className=\"space-y-3\">\n            <button \n              onClick={() => window.location.reload()}\n              className=\"w-full bg-blue-500 hover:bg-blue-600 text-white px-6 py-3 rounded-xl font-medium\"\n            >\n              🔄 Refresh Page\n            </button>\n            <button \n              onClick={() => setHasError(false)}\n              className=\"w-full bg-gray-200 hover:bg-gray-300 text-gray-700 px-6 py-3 rounded-xl font-medium\"\n            >\n              🚫 Dismiss\n            </button>\n          </div>\n        </div>\n      </div>\n    );\n  }\n\n  return (\n    <ErrorBoundary\n      onError={(error) => {\n        console.error('MediaPipe Error:', error);\n        setErrorMessage(error.message || 'An error occurred with MediaPipe');\n        setHasError(true);\n      }}\n    >\n      {children}\n    </ErrorBoundary>\n  );\n};\n\n// Simple ErrorBoundary component\nclass ErrorBoundary extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = { hasError: false };\n  }\n\n  static getDerivedStateFromError(error) {\n    return { hasError: true };\n  }\n\n  componentDidCatch(error, errorInfo) {\n    if (this.props.onError) {\n      this.props.onError(error);\n    }\n  }\n\n  render() {\n    if (this.state.hasError) {\n      return null; // Let parent handle the error display\n    }\n    return this.props.children;\n  }\n}\n\nexport default function Measure() {\n  const videoRef = useRef(null);\n  const canvasRef = useRef(null);\n  const poseRef = useRef(null);\n  const camRef = useRef(null);\n\n  const [phase, setPhase] = useState(\"calibrate\"); // 'calibrate' | 'measure' | 'locked'\n  const [status, setStatus] = useState(\"Hold an A4 sheet at chest level and match the bar width.\");\n    const [barPx, setBarPx] = useState(300);\n  const [cmPerPx, setCmPerPx] = useState(null);\n  const [calibrationQuality, setCalibrationQuality] = useState(0);\n  const [calibrationResults, setCalibrationResults] = useState([]);\n  const [currentCalibrationObject, setCurrentCalibrationObject] = useState(CALIBRATION_OBJECTS[0]);\n  const [calibrationStep, setCalibrationStep] = useState(0);\n  // 'Men' | 'Women' | 'Unisex'\n\n  const [locked, setLocked] = useState(false);\n  const [meas, setMeas] = useState(null); // { chestCm, shoulderCm, upperWaistCm, quality }\n\n  // stability settings\n  const GUIDE_MARGIN = 0.08;\n  const STABILITY_FRAMES = 12;\n  const MOVEMENT_EPS = 0.015;\n  const recentShoulderN = useRef([]);\n  const chestBuf = useRef([]);\n  const shoulderBuf = useRef([]);\n  const waistBuf = useRef([]);\n\n  const getDistance = useCallback((a,b)=>Math.hypot(a.x-b.x,a.y-b.y),[]);\n\n  const stopCamera = () => {\n    try {\n      camRef.current?.stop?.();\n      const v = videoRef.current;\n      v?.srcObject && v.srcObject.getTracks().forEach(t=>t.stop());\n      if (v) v.srcObject = null;\n    } catch {}\n  };\n\n  const startCamera = async (pose) => {\n    const v = videoRef.current;\n    const camera = new Camera(v, {\n      onFrame: async () => { await pose.send({ image: v }); },\n      width: 1280, height: 720,\n    });\n    camRef.current = camera;\n    camera.start();\n  };\n\n    useEffect(() => {\n    const canvas = canvasRef.current;\n    const ctx = canvas.getContext(\"2d\");\n\n    // Simple MediaPipe initialization with error handling\n    try {\n      const pose = new Pose({\n        // Load from local public assets & force non‑SIMD to avoid WASM crash\n        locateFile: (file) => `/mediapipe/pose/${file.replace('simd_', '')}`,\n      });\n      poseRef.current = pose;\n\n      pose.setOptions({\n        modelComplexity: 0, // Use lowest complexity to avoid crashes\n        smoothLandmarks: true,\n        enableSegmentation: false,\n        minDetectionConfidence: 0.6, // Higher confidence for stability\n        minTrackingConfidence: 0.6,\n      });\n\n      pose.onResults((res) => {\n        if (locked) return;\n\n        const W = res.image.width, H = res.image.height;\n        if (canvas.width !== W) canvas.width = W;\n        if (canvas.height !== H) canvas.height = H;\n\n      ctx.save();\n      ctx.clearRect(0,0,W,H);\n      ctx.drawImage(res.image,0,0,W,H);\n\n      // Enhanced guide box with gradient\n      const gx = W*GUIDE_MARGIN, gy = H*GUIDE_MARGIN;\n      const gW = W*(1-GUIDE_MARGIN*2), gH = H*(1-GUIDE_MARGIN*2);\n      const gradient = ctx.createLinearGradient(gx, gy, gx + gW, gy + gH);\n      gradient.addColorStop(0, \"rgba(59, 130, 246, 0.8)\"); // Blue\n      gradient.addColorStop(0.5, \"rgba(16, 185, 129, 0.8)\"); // Emerald\n      gradient.addColorStop(1, \"rgba(139, 92, 246, 0.8)\"); // Purple\n      ctx.strokeStyle = gradient;\n      ctx.lineWidth = 4; \n      ctx.strokeRect(gx, gy, gW, gH);\n\n      // calibration bar with better styling\n      if (phase === \"calibrate\") {\n        const barH = 20;\n        const barY = H * 0.12;\n        \n        // Bar background with gradient\n        const barGradient = ctx.createLinearGradient((W-barPx)/2, barY, (W-barPx)/2 + barPx, barY);\n        barGradient.addColorStop(0, \"rgba(59, 130, 246, 0.9)\");\n        barGradient.addColorStop(1, \"rgba(16, 185, 129, 0.9)\");\n        ctx.fillStyle = barGradient;\n        ctx.fillRect((W-barPx)/2, barY, barPx, barH);\n        \n        // Bar border\n        ctx.strokeStyle = \"rgba(255, 255, 255, 0.9)\";\n        ctx.lineWidth = 2;\n        ctx.strokeRect((W-barPx)/2, barY, barPx, barH);\n        \n        // Instruction text with better styling\n        ctx.font = \"16px system-ui, -apple-system, sans-serif\";\n        ctx.fillStyle = \"rgba(255, 255, 255, 0.95)\";\n        ctx.strokeStyle = \"rgba(0, 0, 0, 0.5)\";\n        ctx.lineWidth = 3;\n        const text = \"Match this bar to A4 width (21 cm) at chest depth\";\n        const textX = Math.max(20, (W - ctx.measureText(text).width) / 2);\n        ctx.strokeText(text, textX, barY - 15);\n        ctx.fillText(text, textX, barY - 15);\n      }\n\n      const lm = res.poseLandmarks;\n      if (!lm) { setStatus(\"Detecting body…\"); ctx.restore(); return; }\n\n      // Enhanced overlay with better colors\n      drawBBox(ctx, lm, W, H, \"rgba(16, 185, 129, 0.9)\");\n      UPPER.forEach(([a,b])=>drawSeg(ctx,lm,a,b,\"#3B82F6\",4,W,H)); // Blue\n      LOWER.forEach(([a,b])=>drawSeg(ctx,lm,a,b,\"#F59E0B\",4,W,H)); // Amber\n\n      const vis = (i) => (lm[i]?.visibility ?? 0) > 0.45;\n      const shouldersOK = vis(11) && vis(12);\n      const hipsOK = vis(23) || vis(24);\n      if (!(shouldersOK && hipsOK)) { setStatus(\"Show shoulders & upper torso.\"); ctx.restore(); return; }\n\n      const Lsh = lm[11], Rsh = lm[12];\n      const Lhip = lm[23], Rhip = lm[24];\n      const hip = vis(23) ? Lhip : Rhip;\n\n      // Enhanced key dots with glow effect\n      const shMid = { x:(Lsh.x+Rsh.x)/2, y:(Lsh.y+Rsh.y)/2 };\n      const keyPoints = [\n        { point: Lsh, color: \"#3B82F6\" },\n        { point: Rsh, color: \"#3B82F6\" },\n        { point: shMid, color: \"#10B981\" },\n        { point: hip, color: \"#F59E0B\" }\n      ];\n      \n      keyPoints.forEach(({point, color}) => {\n        if (point) {\n          // Glow effect\n          ctx.shadowColor = color;\n          ctx.shadowBlur = 15;\n          ctx.fillStyle = color;\n          ctx.beginPath(); \n          ctx.arc(point.x*W, point.y*H, 8, 0, Math.PI*2); \n          ctx.fill();\n          \n          // Inner bright dot\n          ctx.shadowBlur = 0;\n          ctx.fillStyle = \"white\";\n          ctx.beginPath(); \n          ctx.arc(point.x*W, point.y*H, 4, 0, Math.PI*2); \n          ctx.fill();\n        }\n      });\n      ctx.shadowBlur = 0;\n\n      // must be inside guide\n      const inside = [Lsh,Rsh,hip].every(p => p.x*W>=gx && p.x*W<=gx+gW && p.y*H>=gy && p.y*H<=gy+gH);\n      if (!inside) { setStatus(\"Step back/center inside the frame.\"); ctx.restore(); return; }\n\n      if (phase === \"calibrate\") { setStatus(\"Adjust bar → Set calibration.\"); ctx.restore(); return; }\n      if (!cmPerPx) { setStatus(\"Click Set calibration first.\"); ctx.restore(); return; }\n\n      // normalized stability\n      const shoulderWidthN = getDistance(Lsh,Rsh);\n      const torsoHeightN = getDistance(shMid, hip);\n      if (torsoHeightN <= 0) { setStatus(\"Hold still…\"); ctx.restore(); return; }\n\n      const bufN = recentShoulderN.current;\n      bufN.push(shoulderWidthN); if (bufN.length > STABILITY_FRAMES) bufN.shift();\n      const avg = bufN.reduce((a,b)=>a+b,0)/bufN.length;\n      const maxDev = Math.max(...bufN.map(v=>Math.abs(v-avg)));\n\n      // ----- measurements in cm -----\n      const shoulderPx = Math.abs((Lsh.x - Rsh.x) * W);\n      const shoulderCm = shoulderPx * cmPerPx;\n\n      const chestCmInstant = shoulderCm * CHEST_MULTIPLIER;\n\n      let upperWaistCmInstant = null;\n      if (vis(23) && vis(24)) {\n        const hipFlatCm = Math.abs((Lhip.x - Rhip.x) * W) * cmPerPx;\n        upperWaistCmInstant = hipFlatCm * UPPER_WAIST_FACTOR;\n      }\n\n      // median smoothing\n      const pushMed = (ref, val, n=15) => {\n        if (val==null) return null;\n        ref.current.push(val);\n        if (ref.current.length>n) ref.current.shift();\n        const s=[...ref.current].sort((a,b)=>a-b);\n        const m=Math.floor(s.length/2);\n        return s.length%2 ? s[m] : (s[m-1]+s[m])/2;\n      };\n      const chestMed = pushMed(chestBuf, chestCmInstant);\n      const shoulderMed = pushMed(shoulderBuf, shoulderCm);\n      const waistMed = pushMed(waistBuf, upperWaistCmInstant);\n\n      // stability: normalized shoulders + cm spread\n      const spread = chestBuf.current.length>=8 ? Math.max(...chestBuf.current)-Math.min(...chestBuf.current) : 999;\n      const stable = bufN.length>=STABILITY_FRAMES && maxDev < MOVEMENT_EPS && spread < 1.8; // slightly relaxed\n\n      if (stable && chestMed && shoulderMed) {\n        const out = {\n          chestCm: Number(chestMed.toFixed(1)),\n          shoulderCm: Number(shoulderMed.toFixed(1)),\n          upperWaistCm: waistMed ? Number(waistMed.toFixed(1)) : undefined,\n          quality: { frames: chestBuf.current.length, spreadCm: Number(spread.toFixed(2)) }\n        };\n        setMeas(out);\n        setLocked(true);\n        setPhase(\"locked\");\n        setStatus(\"Locked ✔️\");\n        stopCamera();\n      } else {\n        setStatus(\"Hold still…\");\n      }\n\n      ctx.restore();\n    });\n\n    startCamera(pose);\n    return () => { stopCamera(); };\n  } catch (error) {\n    console.error(\"❌ MediaPipe initialization failed:\", error);\n    setStatus(`MediaPipe Error: ${error.message}. Please refresh the page.`);\n    setPhase(\"error\");\n  }\n  }, [phase, cmPerPx, getDistance, locked, barPx]);\n\n  const setCalibration = () => {\n    if (barPx < 40) return;\n    setCmPerPx(A4_WIDTH_CM / barPx);\n    setPhase(\"measure\");\n    setStatus(\"Calibration set. Stand centered; shoulders & upper torso visible.\");\n    // reset buffers\n    chestBuf.current = []; shoulderBuf.current = []; waistBuf.current = []; recentShoulderN.current = [];\n  };\n\n  const retake = () => {\n    setLocked(false); setMeas(null); setPhase(\"measure\");\n    setStatus(\"Stand centered; hold still 1–2 seconds.\");\n    chestBuf.current = []; shoulderBuf.current = []; waistBuf.current = []; recentShoulderN.current = [];\n    if (poseRef.current) startCamera(poseRef.current);\n  };\n\n  const recalibrate = () => {\n    setLocked(false); setMeas(null); setPhase(\"calibrate\");\n    setStatus(\"Hold an A4 sheet at chest level and match the bar width.\");\n    chestBuf.current = []; shoulderBuf.current = []; waistBuf.current = []; recentShoulderN.current = [];\n    if (poseRef.current) startCamera(poseRef.current);\n  };\n\n  // Helper functions for UI\n  const getStatusIcon = () => {\n    if (phase === \"locked\") return <span className=\"text-emerald-500 text-xl\">✅</span>;\n    if (phase === \"measure\") return <Activity className=\"w-5 h-5 text-blue-500 animate-pulse\" />;\n    return <Target className=\"w-5 h-5 text-amber-500\" />;\n  };\n\n  const getPhaseColor = () => {\n    if (phase === \"locked\") return \"from-emerald-500 to-green-500\";\n    if (phase === \"measure\") return \"from-blue-500 to-cyan-500\";\n    return \"from-amber-500 to-orange-500\";\n  };\n\n  return (\n    <MediaPipeErrorBoundary>\n      <div className=\"min-h-screen bg-gradient-to-br from-gray-900 via-blue-900 to-indigo-900 relative overflow-hidden\">\n        {/* Animated Background */}\n        <div className=\"absolute inset-0\">\n          <div className=\"absolute top-10 left-10 w-72 h-72 bg-blue-500/10 rounded-full blur-3xl animate-pulse\"></div>\n          <div className=\"absolute bottom-10 right-10 w-96 h-96 bg-emerald-500/10 rounded-full blur-3xl animate-pulse delay-1000\"></div>\n          <div className=\"absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 w-80 h-80 bg-purple-500/5 rounded-full blur-3xl animate-pulse delay-2000\"></div>\n        </div>\n\n        <div className=\"relative z-10 flex flex-col items-center min-h-screen\">\n          {/* Enhanced Header */}\n          <div className=\"w-full max-w-7xl flex items-center justify-between px-6 py-6\">\n            <div className=\"flex items-center space-x-4\">\n              <div className=\"w-12 h-12 bg-gradient-to-r from-blue-500 to-emerald-500 rounded-2xl flex items-center justify-center shadow-lg\">\n                <Sparkles className=\"w-7 h-7 text-white\" />\n              </div>\n              <div>\n                <h1 className=\"text-2xl font-bold text-white\">AI Fashion Fit</h1>\n                <p className=\"text-sm text-blue-200\">Body Measurement System</p>\n              </div>\n            </div>\n            \n            {/* Enhanced Status Badge */}\n            <div className=\"flex items-center space-x-3\">\n              <div className={`bg-gradient-to-r ${getPhaseColor()} rounded-full px-6 py-3 shadow-lg backdrop-blur-sm border border-white/10`}>\n                <div className=\"flex items-center space-x-3 text-white\">\n                  {getStatusIcon()}\n                  <span className=\"font-medium text-sm\">{status}</span>\n                </div>\n              </div>\n            </div>\n          </div>\n\n          {/* Enhanced Camera Section */}\n          <div className=\"w-full max-w-6xl px-6 flex-1 flex items-center\">\n            <div className=\"relative w-full bg-black/20 backdrop-blur-lg rounded-3xl overflow-hidden shadow-2xl border border-white/10\">\n              <div className=\"relative aspect-video\">\n                <video ref={videoRef} className=\"absolute inset-0 w-full h-full object-contain bg-black rounded-3xl\" autoPlay muted playsInline />\n                <canvas ref={canvasRef} className=\"absolute inset-0 w-full h-full object-contain pointer-events-none\" />\n\n                {/* Enhanced Multi-Object Calibration UI */}\n                {phase === \"calibrate\" && (\n                  <div className=\"absolute bottom-6 left-1/2 transform -translate-x-1/2\">\n                    <div className=\"bg-white/95 backdrop-blur-md rounded-2xl px-8 py-6 shadow-2xl border border-white/20 max-w-4xl\">\n                      <div className=\"text-center mb-4\">\n                        <h3 className=\"text-lg font-bold text-gray-800 mb-2\">Advanced Calibration System</h3>\n                        <p className=\"text-sm text-gray-600\">Use multiple objects for higher accuracy</p>\n                      </div>\n                      \n                      {/* Calibration Object Selection */}\n                      <div className=\"flex justify-center space-x-4 mb-4\">\n                        {CALIBRATION_OBJECTS.map((obj, index) => (\n                          <button\n                            key={obj.name}\n                            onClick={() => setCurrentCalibrationObject(obj)}\n                            className={`px-4 py-2 rounded-lg text-sm font-medium transition-all ${\n                              currentCalibrationObject.name === obj.name\n                                ? 'bg-blue-500 text-white shadow-lg'\n                                : 'bg-gray-100 text-gray-700 hover:bg-gray-200'\n                            }`}\n                          >\n                            {obj.name}\n                          </button>\n                        ))}\n                      </div>\n                      \n                      {/* Current Object Info */}\n                      <div className=\"text-center mb-4\">\n                        <div className=\"text-sm text-gray-600 mb-2\">\n                          {currentCalibrationObject.description}\n                        </div>\n                        <div className=\"text-lg font-bold text-blue-600\">\n                          Expected Width: {currentCalibrationObject.width}cm\n                        </div>\n                      </div>\n                      \n                      {/* Calibration Controls */}\n                      <div className=\"flex items-center justify-center space-x-4\">\n                        <div className=\"flex items-center space-x-2\">\n                          <Target className=\"w-5 h-5 text-amber-600\" />\n                          <span className=\"text-sm font-medium text-gray-700\">\n                            Adjust bar to match {currentCalibrationObject.name} width\n                          </span>\n                        </div>\n                        <input \n                          type=\"range\" \n                          min={120} \n                          max={900} \n                          value={barPx} \n                          onChange={(e)=>setBarPx(Number(e.target.value))} \n                          className=\"w-64 accent-blue-500\"\n                        />\n                        <button \n                          onClick={() => performCalibration(currentCalibrationObject)}\n                          className=\"bg-gradient-to-r from-blue-500 to-emerald-500 hover:from-blue-600 hover:to-emerald-600 text-white px-4 py-2 rounded-xl font-medium transition-all duration-300 transform hover:scale-105 shadow-lg flex items-center space-x-2\"\n                        >\n                          <span className=\"text-white text-lg\">📏</span>\n                          <span>Calibrate</span>\n                        </button>\n                      </div>\n                      \n                      {/* Calibration Results */}\n                      {calibrationResults.length > 0 && (\n                        <div className=\"mt-4 p-3 bg-gray-50 rounded-lg\">\n                          <div className=\"text-sm font-medium text-gray-700 mb-2\">Calibration Results:</div>\n                          <div className=\"space-y-1\">\n                            {calibrationResults.map((result, index) => (\n                              <div key={index} className=\"text-xs text-gray-600\">\n                                {result.object}: {result.measuredCm.toFixed(2)}cm (Expected: {result.expectedCm}cm) - \n                                Accuracy: {(result.accuracy * 100).toFixed(1)}%\n                              </div>\n                            ))}\n                          </div>\n                          <div className=\"mt-2 text-sm font-bold text-gray-800\">\n                            Overall Quality: {(calibrationQuality * 100).toFixed(1)}%\n                          </div>\n                        </div>\n                      )}\n                      \n                      {/* Proceed Button */}\n                      {calibrationQuality >= CALIBRATION_THRESHOLD && (\n                        <div className=\"mt-4 text-center\">\n                          <button \n                            onClick={() => {\n                              setPhase(\"measure\");\n                              setStatus(\"Calibration complete! Position yourself in the frame.\");\n                            }}\n                            className=\"bg-gradient-to-r from-emerald-500 to-green-500 hover:from-emerald-600 hover:to-green-600 text-white px-6 py-3 rounded-xl font-medium transition-all duration-300 transform hover:scale-105 shadow-lg\"\n                          >\n                            🎯 Proceed to Measurement\n                          </button>\n                        </div>\n                      )}\n                    </div>\n                  </div>\n                )}\n\n\n\n\n              </div>\n            </div>\n          </div>\n\n\n\n          {/* Enhanced Instructions */}\n          <div className=\"w-full max-w-4xl px-6 py-4\">\n            <div className=\"bg-white/10 backdrop-blur-md rounded-2xl p-6 border border-white/20\">\n              <div className=\"text-center text-white\">\n                <div className=\"flex items-center justify-center space-x-2 mb-3\">\n                  <CameraIcon className=\"w-5 h-5 text-blue-300\" />\n                  <h3 className=\"font-semibold\">Instructions</h3>\n                </div>\n                <div className=\"text-sm text-white/80 space-y-2\">\n                  {phase === \"calibrate\" && (\n                    <p>📄 Hold an A4 sheet at chest level and adjust the bar to match its width for accurate calibration.</p>\n                  )}\n                  {phase === \"measure\" && (\n                    <p>🧍 Stand straight with arms slightly away from your body. Hold still for precise measurement.</p>\n                  )}\n                  {phase === \"locked\" && (\n                    <p>✅ Measurements captured successfully! You can retake if needed or save your results.</p>\n                  )}\n                </div>\n              </div>\n            </div>\n          </div>\n\n          {/* Fallback Results Display - Always visible when measurements exist */}\n          {phase === \"locked\" && meas && (\n            <div className=\"w-full max-w-4xl px-6 py-6\">\n              <div className=\"bg-white/95 backdrop-blur-md rounded-2xl p-6 border border-gray-200 shadow-xl\">\n                <div className=\"text-center text-gray-800\">\n                  <h3 className=\"text-xl font-bold mb-4\">📊 Measurement Results</h3>\n                  \n                  {/* Measurements Grid */}\n                  <div className=\"grid grid-cols-1 md:grid-cols-3 gap-4 mb-6\">\n                    <div className=\"bg-blue-50 rounded-xl p-4 border border-blue-200\">\n                      <div className=\"text-2xl font-bold text-blue-600\">{meas.chestCm?.toFixed(1) || 'N/A'}</div>\n                      <div className=\"text-sm text-blue-500\">Chest (cm)</div>\n                    </div>\n                    <div className=\"bg-emerald-50 rounded-xl p-4 border border-emerald-200\">\n                      <div className=\"text-2xl font-bold text-emerald-600\">{meas.shoulderCm?.toFixed(1) || 'N/A'}</div>\n                      <div className=\"text-sm text-emerald-500\">Shoulder (cm)</div>\n                    </div>\n                    <div className=\"bg-purple-50 rounded-xl p-4 border border-purple-200\">\n                      <div className=\"text-2xl font-bold text-purple-600\">{meas.upperWaistCm?.toFixed(1) || 'N/A'}</div>\n                      <div className=\"text-sm text-purple-500\">Waist (cm)</div>\n                    </div>\n                  </div>\n\n                  {/* Size Recommendation */}\n                  <div className=\"bg-gradient-to-r from-blue-50 to-emerald-50 rounded-xl p-4 mb-6 border border-blue-200\">\n                    <div className=\"text-lg font-semibold text-gray-700 mb-2\">Recommended Size</div>\n                                      <div className=\"text-3xl font-bold bg-gradient-to-r from-blue-600 to-emerald-600 bg-clip-text text-transparent\">\n                    {recommendTopSize(meas.chestCm, meas.upperWaistCm, meas.shoulderCm)}\n                  </div>\n                  </div>\n\n                  {/* Action Buttons */}\n                  <div className=\"flex flex-col sm:flex-row gap-3 justify-center\">\n                    <button \n                      onClick={retake}\n                      className=\"bg-gray-200 hover:bg-gray-300 text-gray-700 px-6 py-3 rounded-xl font-medium transition-all duration-300 border-2 border-gray-300\"\n                    >\n                      🔄 Retake\n                    </button>\n                    <button \n                      onClick={recalibrate}\n                      className=\"bg-blue-100 hover:bg-blue-200 text-blue-700 px-6 py-3 rounded-xl font-medium transition-all duration-300 border-2 border-blue-300\"\n                    >\n                      🎯 Recalibrate\n                    </button>\n                    <button \n                      onClick={() => {\n                        const recommendedSize = recommendTopSize(meas.chestCm, meas.upperWaistCm, meas.shoulderCm);\n                        if (recommendedSize) {\n                          // Pass all measurement data to recommendations page\n                          const measurementData = encodeURIComponent(JSON.stringify({\n                            size: recommendedSize,\n                            gender: 'Men',\n                            measurements: {\n                              chestCm: meas.chestCm,\n                              shoulderCm: meas.shoulderCm,\n                              upperWaistCm: meas.upperWaistCm\n                            }\n                          }));\n                          window.location.href = `/recommendations?data=${measurementData}`;\n                        }\n                      }}\n                      className=\"bg-gradient-to-r from-purple-500 to-pink-500 hover:from-purple-600 hover:to-pink-600 text-white px-6 py-3 rounded-xl font-medium transition-all duration-300 shadow-lg\"\n                    >\n                      ✨ Get Recommendations\n                    </button>\n                  </div>\n                </div>\n              </div>\n            </div>\n          )}\n        </div>\n      </div>\n    </MediaPipeErrorBoundary>\n  );\n}"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}